{"version":3,"sources":["assets/scripts/indexeddb/store.js","assets/scripts/indexeddb/missions.js","assets/scripts/index.js"],"names":["indexedDB","window","mozIndexedDB","webkitIndexedDB","msIndexedDB","IDBTransaction","webkitIDBTransaction","msIDBTransaction","IDBKeyRange","webkitIDBKeyRange","msIDBKeyRange","Store","storeName","Error","name","databaseName","database","IDBDatabase","TypeError","version","onclose","isOpen","close","Number","isSafeInteger","openVersion","closeDB","promise","Promise","resolve","reject","request","open","onsuccess","setDB","result","onerror","event","target","error","onupgradeneeded","tx","transaction","objectStoreNames","contains","createObjectStore","keyPath","autoIncrement","objectStore","createIndex","unique","openDB","then","column","option","columnOption","db","store","indexNames","deleteIndex","columns","Array","newColumns","forEach","columnType","push","index","id","isReady","delete","ids","length","ready","deleteItem","args","isInt","isArray","deleteItems","item","undefined","put","items","setItem","isObj","setItems","get","sortIds","sort","range","bound","getAll","resPromise","includes","idQuery","getItem","getItems","indexName","openIndexName","attrQuery","keys","Object","firstIndex","only","isEqual","key","missions","create","set","save","init","addColumns","isKeyEnter","KeyboardEvent","keyCode","isElement","element","nodeType","isString","str","getParent","parentNode","getParents","parent","Index","i","getIndex","Dom","query","eleReg","eleMatch","match","tagName","toLocaleUpperCase","dom","document","createElement","querySelectorAll","console","warn","value","setAttribute","getAttribute","content","ary","split","classList","add","remove","object","appendChild","removeChild","querySelector","innerText","innerHTML","parents","all","callback","addEventListener","removeEventListener","$","of","Message","body","ReferenceError","box","attr","append","message","prepareBox","popup","addClass","html","buttons","cancel","text","on","submitCallback","submitText","submit","Mission","listElement","formElement","adderElement","loadDB","counter","results","after","before","order","missionItem","createMissionItem","date","openForm","find","adderParent","missionItems","removeClass","insertBefore","itemId","createMission","updateMission","formInputs","children","input","click","hideForm","handleId","handleItem","finishItemButtons","button","initDocument","supportMission","ondragover","preventDefault","ondrop","data","dataTransfer","getData","dragItem","ondragend","dragId","dragIndex","isSameNode","prevItem","nextItem","prevOrder","nextOrder","isFinite","newOrder","updateData","alert","isFormHide","hasClass","paths","path","hideFormButton","isInMission","form","contentInput","dateInput","nextSibling","leftText","rightText","isElementComplete","moveIcon","left","right","icon","link","transformItem","setData","itemNext","itemIndex","childNodes","prototype","node","positionItem","dragNext","mission","show","log"],"mappings":";;;;;;;;;AEAA;ADAA;;;ADCA,IAAMA,YAAYC,OAAOD,SAAP,IAChBC,OAAOC,YADS,IAEhBD,OAAOE,eAFS,IAGhBF,OAAOG,WAHT;AAIA,IAAMC,iBAAiBJ,OAAOI,cAAP,IACrBJ,OAAOK,oBADc,IAErBL,OAAOM,gBAFT;AAGA,IAAMC,cAAcP,OAAOO,WAAP,IAClBP,OAAOQ,iBADW,IAElBR,OAAOS,aAFT;ACNA,IAAM+F,WAAW,IAAI9F,eAAJ,CAAU,UAAV,CAAjB;ACAA,IAAMoG,AFUApG,aEVa,SAAboG,UAAa;AAAA,ADEnBN,ADSE,SEX4BpE,ADErBqE,MAAT,EDSc9F,CCTI,QCF6BoG,AFW7C,EAAuB,WEXI,IAAqC3E,MAAM4E,OAAN,KAAkB,EAAjE;AAAA,ADED,ADSO,CEXzB,QDE0BR,SAASE,GAAT,CAAa7B,IAAb,CAAR;AAAA,CAAlB;ACAA,AFUI,IEVEoC,IFUE,CAAClH,OEVS,EFUV,IAAc,CAACK,EEVjB6G,SAAY,GFUV,IAAiC,CAAC1G,WAAtC,EAAmD,MAAM,IAAIK,KAAJ,CAAU,mBAAV,CAAN;AEVrC,ADElB4F,ADSI,SEX0BU,ADErBP,ADSA9F,ICTT,ADSI,GCTY,ADSA,IEX0BqG,CFWrBrG,IAAL,GEXkCsG,CFWrBxG,OEXa,EFWtC,GEX2D,CAA7C;AAAA,ADEF,ADUZ,CEZJ,QDEwB6F,ADUf1F,SCVwB4F,GAAT,ADUpB,CCViC7B,EDUb,ECVA,CAAR,cDUZ;ACVY,ADWZ,CCXJ,UDWW,IAAP;AEXJ,AFYG,IEZGuC,WAAW,SAAXA,QAAW;AAAA,ADEjBZ,SCFyBa,ADEhBT,IAAT,GCFiC,ADEjB,OCFwBS,GAAP,EDEX,GCF0B,QAA/B;AAAA,ADGf,CCHF,KDGMb,SAASI,IAAT,KAAkB,CAAtB,EAAyB,OAAO,KAAP;AACzBJ,WAASI,IAAT,GAAgB,CAAhB;ACFF,ADGE,ICHIU,KDGGd,OCHS,EDGAjC,KAAT,ECHH+C,CDGoBnE,ADSlBpC,ICTC,CAAsB,GCHb,CAACmG,CFYD,MEZA,EAAa;AAC7B,ADE6B,ADSb,MEXZ,CAACD,IDE8BT,MCFpBU,GDE6BL,ICFvC,CAAL,EAAyB,GDEU,CAAoB,CAAC,ECFxB,IDEuB,CCF9B,CDEuC,SAAT,EAAoB,OAApB,CAApB,CAAN;ACD7B,ADC6B,GAAtB,CAAP,KCDOK,QAAQK,UAAf;AACD,ADCA,ADSG,CEbJ,ADAA,SDaQ,CAACxG,QAAD,IAAa,EAAEA,oBAAoBC,WAAtB,CAAjB,EAAqD,MAAM,IAAIC,SAAJ,CAAc,WAAd,CAAN;ACRzDuF,ADSI,SCTKI,EDSA7F,ECTT,MDSI,GAAgBA,QAAhB;AETJ,AFUI,IEVEyG,OFUGtG,MEVU,CFUf,GAAe,KEVbsG,AFUkBzG,QAAL,CAAcG,CEVd,CAACgG,KFUhB,EEVe,EAAa;AAC9B,AFUE,MEVE,CAACD,IFUElG,MEVQmG,CDCFV,CDSX,CAAcrF,IEVX,CAAL,EAAyB,AFUvB,GAAwB,IEVM,KAAP,GFUO;AEThC,AFUI,MEVEe,QFUGnB,CEVM,EAAf,KFUI,CAAcK,MAAd,GAAuB,KAAvB;AETJ,AFUG,MEVCqG,CFQF,QERWP,OAAb;AACA,AFUE,OEVG,IAAIjD,EFUAlD,MEVQ,CAAjB,CFUE,CEVkBkD,QAAQ,GAA5B,EAAiCA,SAAS,CAA1C,EAA6C;AAC3CwD,AFUD,aEVUH,UAAUG,MAAV,CAAT;AACA,QAAI,CAACR,UAAUQ,MAAV,CAAL,EAAwB;AACxBvF,WAAO8B,IAAP,CAAYyD,MAAZ;AACD,8BFSS;AERV,AFSE,SETKvF,IFSE,EETT,GFScnB,QAAL,IAAkB,KAAKA,QAAL,YAAyBC,WAA3C,IAA2D,KAAKD,QAAL,CAAcM,KAAd,EAAlE;AERH,AFSE,CEnBH;;AAYA,IAAMqG,QAAQ;AACZC,KAAG,CADS,qBFSLzG,SAAS;AEPhB0G,AFOgB,YEPN,oBAAM;AACdF,UAAMC,CAAN,IAAW,CAAX;AACA,AFMA,WENOD,MAAMC,CAAb;AACD,AFMC;AEXU,AFYV,CEZJ;AFaI,UAAIzG,OAAJ,EAAa;AACX,IENA2G,QFMI,CAACvG,OAAOC,aAAP,CAAqBL,OAArB,CAAL,EAAoC,MAAM,IAAID,SAAJ,CAAc,UAAd,CAAN;AELxC,AFMI,YAAIC,GENI4G,KAAZ,EAAmB,AFMD,KAAK5G,OAAnB,EAA4B,MAAM,IAAID,SAAJ,CAAc,eAAd,CAAN;AENb,AFOhB;AACD,UAAMO,cAAeN,WAAWI,OAAOC,aAAP,CAAqBL,OAArB,CAAX,IAA6CA,UAAU,KAAKA,OAA7D,GAChBA,OADgB,GACN,KAAKA,OADnB;AEPA,AFSA,QETI,GFSCO,IETMqG,GFSX,EETI,KAAiB,QAArB,EAA+B;AAC7B,AFSF,UETQC,AFSFrG,SETW,CFSD,IAAIC,KETlB,EFSc,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AER/C,AFSA,UETMmG,WAAWF,MAAMG,KAAN,CAAYF,MAAZ,CAAjB;AACA,AFSA,UETIC,EFSElG,METN,EAAc,EFSGZ,WAAWI,OAAOC,aAAP,CAAqBL,OAArB,CAAX,IAA6CA,UAAU,OAAKA,OAA7D,GACZnB,UAAUgC,IAAV,CAAe,OAAKjB,YAApB,EAAkCU,WAAlC,CADY,GAEZzB,UAAUgC,IAAV,CAAe,OAAKjB,YAApB,CAFJ;AERE,AFWFgB,YEXQoG,IFWAlG,MEXUgG,GFWlB,GAAoB,GEXO,CAAT,EAAYG,MFWJ,WEXR,EAAhB;AACA,AFWA,aEXKC,GAAL,CFWKnG,EEXMoG,GFWX,CAAWvG,KEXSwG,GFWDpG,MAAnB,IEXW,CAAuBgG,OAAvB,CAAX;AACD,AFWC,OEdF,MAGO,IFWAnH,QAAL,CAAcK,MAAd,GAAuB,IAAvB;AEVA,AFWAQ,eEXOyG,GFWC,MEXQE,CFWHxH,QAAb,OEXO,CAA0B+G,KAA1B,CAAP;AACD,AFWA,SAJD;AEND,AFWChG,KEpBF,MASO,IAAIgG,CFWD3F,OAAR,GAAkB,MEXQ0F,GAArB,CFWczF,CEXY,IFWb,EAAW;AEV7B,AFU+BP,WEV1BuG,GAAL,GAAWN,AFU2B1F,MEVrBgG,AFU2B/F,GEV5C,GFUsC,CAAaC,KAApB;AEThC,AFS6D,KEXvD,IFWL,EETK,IAAI2E,UAAUa,KAAV,KAAqBA,UAAUO,QAAnC,EAA8C;AACnD,AFSAvG,WETKsG,GAAL,EFSQ7F,CETGuF,KAAX,SFSA,GAA0B,UAAC1F,KAAD,EAAW;AERtC,AFSG,KEXG,MAEA,MFSEH,KAAL,CAAWG,MAAMC,MAAN,CAAaH,MAAxB;AERFsG,AFSE,cETMC,AFSAjG,IETR,CAAasF,AFSA1F,KETb,CFSmBC,MAAN,CAAaI,WAAxB;AERF,AFSE,YETI,EFSA,CAACD,CETGvB,EFSAyB,OETJ,CAAc,MAAd,CAAN,CFSO,CAAoBC,QAApB,CAA6B,OAAK9B,IAAlC,CAAL,EAA8C;AERjD,AFSK,mBAAKE,QAAL,CAAc6B,iBAAd,CAAgC,OAAK/B,IAArC,EAA2C,EAAEgC,SAAS,IAAX,EAAiBC,eAAe,IAAhC,EAA3C;AERN,AFSMN,WETC,IAAP,AFSSO,WAAH,CAAe,OAAKlC,IAApB,EAA0BmC,WAA1B,CAAsC,IAAtC,EAA4C,IAA5C,EAAkD,EAAEC,QAAQ,IAAV,EAAlD;AERP,AFSM;AACF,SAPD;AAQD,OAnBe,CAAhB;AAoBA,aAAOvB,OAAP;AACD,yBEPI6E,KAAKmC,OAAO;AACf,UAAI,CAACnC,GAAD,IAAQ,CAACa,SAASb,GAAT,CAAb,EAA4B,MAAM,IAAItF,SAAJ,CAAc,SAAd,CAAN;AAC5B,UAAIiB,SAAS,IAAb;AACA,UAAIwG,UAAU5D,QFMR,CENN,EAAyB;AACvB,AFKI,aELCsD,GAAL,CAASO,YAAT,CAAsBpC,GAAtB,OAA8BmC,KAA9B;AACD,OAFD,MAEO;AACLxG,AFIF,aAAO,IEJI,CFICgB,IEJIkF,EFIT,CEJI,CAASQ,CFICzF,IAAd,CAAmB,MEJf,CAAsBoD,GAAtB,CAAT;AACD,AFGyB,eAAY,OAAKtE,KAAL,CAAWlB,QAAX,CAAZ;AEF1B,AFE0B,OAAnB,CAAP,KEFOmB,MAAP;AACD,AFEA;;;6BEAQ2G,CFEC,QEFQ;AAAA,AFGhB,aAAO,KAAK9H,QAAL,IAAkB,KAAKA,QAAL,YAAyBC,WAA3C,IAA2D,KAAKD,QAAL,CAAcK,MAAhF;AACD;AEHC,UAAI,CAACyH,OAAD,IAAa,OAAOA,OAAP,KAAmB,QAApC,EAA+C,MAAM,IAAI5H,SAAJ,CAAc,UAAd,CAAN;AAC/C,UAAM6H,MAAMD,QAAQE,KAAR,CAAc,GAAd,CAAZ;AACAD,UAAIhF,OAAJ,CAAY,YFGJV,QAAQC,QAAQ;AEHZ,AFGY,eEHH,MAAK+E,GAAL,CAASY,SAAT,CAAmBC,GAAnB,CAAuBP,KAAvB,CAAT;AAAA,OAAZ;AACA,AFGA,aEHO,IAAP;AACD,AFGC;AACA;AACA,UAAI,CAACtF,MAAD,IAAY,OAAOA,MAAP,KAAkB,QAAlC,EAA6C,MAAM,IAAInC,SAAJ,CAAc,eAAd,CAAN;AAC7C,UAAIoC,UAAW,QAAOA,IEJZwF,EFIK,OEJI,kCFIGxF,MAAP,OAAkB,QAAjC,EAA4C,MAAM,IAAIpC,SAAJ,CAAc,YAAd,CAAN;AEJzB,AFKnB,UAAMqC,eAAe,EAArB;AACAA,mBAAaL,MAAb,GAAsBI,UAAUA,OAAOJ,MAAvC;AELA,AFMA,UENI,AFMEzB,CENDqH,OAAD,IAAa,EFMG,KENIA,AFMC3H,OENR,AFMG,GAAe,CAAnC,CENoC,QAApC,EAA+C,MAAM,IAAID,SAAJ,CAAc,UAAd,CAAN;AAC/C,AFMA,UENM6H,CFMDrH,KENOoH,EFMZ,MENoBE,KAAR,CAAc,GAAd,CAAZ;AACAD,AFMA,UENIhF,AFMEpC,OENN,CAAY,EFMI,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AENrC,AFOV,YAAMC,GEPa,OAAKsG,AFORrI,GEPG,CAASiJ,MFOFjH,GEPP,CAAmBmH,AFOtB,CAAe,KEPZ,CAA0BR,CFOT5H,IEPjB,CAAT,OFOM,EAAkCU,WAAlC,CAAhB;AEPU,AFQVM,OERF,SFQUE,SAAR,GAAoB,YAAM;AEP5B,AFQI,aERG,IAAP,AFQSC,KAAL,CAAWH,QAAQI,MAAnB;AEPL,AFQK,iBAAKnB,QAAL,CAAcK,MAAd,GAAuB,IAAvB;AACAQ,kBAAQ,OAAKb,QAAb;AACD,SAJD;AAKAe,gBAAQK,OAAR,GAAkB,GETb0G,OFSczG,EETL,GFSI,EAAW;AER/B,AFQiCP,UER7B,CAACgH,MFQmCzG,CERpC,IAAa,CFQ6BC,MERtBwG,AFQgB,CAAavG,KAApB,CERhB,KAAmB,QAApC,EAA+C,MAAM,IAAIrB,SAAJ,CAAc,UAAd,CAAN;AAC/C,AFO8D,SAA5D,IEPK,KAAKmH,GAAL,CAASY,SAAT,CAAmBrG,QAAnB,CAA4BkG,OAA5B,CAAP;AACD,AFOG/G,gBAAQS,eAAR,GAA0B,UAACH,KAAD,EAAW;AACnC,cAAMmB,KAAKnB,MAAMC,MAAN,CAAaH,MAAxB;AACA,cAAMM,KAAKJ,MAAMC,MAAN,CAAaI,WAAxB;AACA,iBAAK1B,QAAL,EERCoI,CFQe5F,EAAhB,KERS;AACb,AFQI,UERE2D,OFQGhG,GERQiI,IFQb,GAAe,OAAKpI,IERW8G,GAAnB,CFQG,CAAc3G,CERSiI,MFQtC,CER6Cf,GAAjC,GAAuCe,MAAvD;AACA,AFQI,UERA,CAACjC,GFQK1D,IERN,IAAa0D,AFQE1E,MAAMA,EERA2E,CFQGzE,OERX,KAAqB,CAAtC,EAA0C,CFQjB,CAAoBC,IERG,IAAI1B,AFQ3B,CAA6B,OAAKJ,CERX,CAAc,EFQrC,CAAP,GACV2B,GAAGO,GETqC,CAAN,OFSlC,CAAe,OAAKlC,IAApB,CADU,GAEV0C,GAAGX,iBAAH,CAAqB,OAAK/B,IAA1B,EAAgC,EAAEgC,SAAS,IAAX,EAAiBC,eAAe,IAAhC,EAAhC,CAFJ;AEPJ,AFUI,WEVCsF,GAAL,AFUQ,CEVCgB,AFUA5F,MAAMC,KEVf,CAAqByD,IFUZ,CAAiBvE,EEV1B,MFUS,CAA0B,IAA1B,CAAL,EAAsC;AET1C,AFUMa,aEVC,IAAP,CFUYR,WAAN,CAAkB,IAAlB,EAAwB,IAAxB,EAA8B,EAAEC,QAAQ,IAAV,EAA9B;AETP,AFUM;AACD,cAAI,CAACO,MAAMC,UAAN,CAAiBd,QAAjB,CAA0BS,MAA1B,CAAL,EAAwC;AACtCI,kBAAMR,WAAN,CAAkBI,MAAlB,EAA0BA,MAA1B,EAAkC,EAAEH,QAAQK,aAAaL,MAAvB,EAAlC;AACD,2BEXAkG,QAAQ;AACb,AFWG,SAdD,CEGE,CAACA,MAAL,EAAa;AACX,AFWD,OAvBe,CAAhB,KEYOf,GAAL,CAASc,MAAT;AACD,AFWD,OEbA,MAEO,AFWAxH,IEXIuF,GFWX,OEXqBkC,MAAV,CAAJ,EAAuB;AAC5B,AFWH,aEXQf,GAAL,CAASiB,WAAT,CAAqBF,MAArB;AACD,OAFM,MAEA,IAAI/B,SAAS+B,MAAT,CAAJ,EAAsB;AAC3B,YAAMjC,UAAU,KAAKkB,GAAL,CAASkB,aAAT,CAAuBH,MAAvB,CAAhB;AACA,aAAKf,GAAL,CAASiB,WAAT,CAAqBnC,IFUZ9D,GEVT,KFUiB;AETlB,AFSkB;AERnB,aAAO,IAAP;AACD,AFQC;AACA;AACA,UAAI,CAACA,MAAD,IAAY,OAAOA,MAAP,KAAkB,QAAlC,EAA6C,MAAM,IAAInC,SAAJ,CAAc,eAAd,CAAN;AAC7C,WAAKQ,OAAL,OETGoH,SAAS;AACZ,AFSA,UAAMrH,CETD4G,GAAL,CAASmB,SAAT,AFSoB,GETCV,EFSI3H,KETzB,EFSoB,GAAe,CAAnC;AERA,AFSA,UAAMQ,GETC,IAAP,GFSgB,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AERlD,AFSG,YAAMC,UAAU/B,UAAUgC,IAAV,CAAe,OAAKjB,YAApB,EAAkCU,WAAlC,CAAhB;AACAM,gBAAQE,SAAR,GAAoB,YAAM;AACxB,iBAAKC,KAAL,CAAWH,QAAQI,MAAnB;AACA,iBAAKnB,QEVN8H,AFUC,CAAczH,MAAd,EEVQ,CFUe,IAAvB;AETJ,AFUIQ,WEVCwG,GAAL,CAASoB,GFUG,MEVZ,CFUiBzI,EEVI8H,MFUjB,CEVJ;AACA,AFUG,SAJD,IENK,IAAP;AACD,AFUG/G,gBAAQK,OAAR,GAAkB,UAACC,KAAD,EAAW;AAC3B,iBAAKrB,QAAL,GAAgBe,QAAQI,MAAxB;AACA,iBAAKhB,OAAL,GAAeY,QAAQI,MAAR,CAAehB,OAA9B;AACA,iBAAKH,QEXN+G,AFWC,CAAczG,KAAd,CEXM;AACV,AFWIQ,aEXG,IFWIO,CEXCgG,GAAL,CAASkB,CFWCjH,MAAN,CAAaC,KEXjB,AFWH,CEX0BwF,KAAvB,CAAP;AACD,AFWI,SALD;AAMAhG,gBAAQS,eAAR,GAA0B,UAACH,KAAD,EAAW;AACnC,cAAMmB,KAAKnB,MAAMC,MAAN,CAAaH,MAAxB;AACA,cAAMM,KAAKJ,MAAMC,IEZdyF,EFYQ,CAAarF,IEZd,OFYV;AEXJ,AFYI,aEZG,IFYE1B,CEZGqH,GAAL,CAASG,GFYZ,GAAgBhF,EAAhB,QEZG,CAA0BuE,KAA1B,CAAP;AACD,AFYK,iBAAK5G,OAAL,GAAe,OAAKH,QAAL,CAAcG,OAA7B;AACA,cAAMsC,QAAShB,MAAMA,GAAGE,gBAAH,CAAoBC,QAApB,CAA6B,OAAK9B,IAAlC,CAAP,GACV2B,GAAGO,WAAH,CAAe,OAAKlC,IAApB,CADU,GAEV0C,GAAGX,iBAAH,CAAqB,OAAK/B,IAA1B,EAAgC,EAAEgC,SAAS,IAAX,EAAiBC,eAAe,IAAhC,EAAhC,CAFJ;AAGA,cAAI,CAACU,MAAMC,UAAN,CAAiBd,QAAjB,CAA0B,IAA1B,CAAL,EAAsC;AACpCa,kBAAMR,WEfL,AFeD,CAAkB,IAAlB,EAAwB,IAAxB,EAA8B,EAAEC,QAAQ,IAAV,EAA9B;AEdN,AFeK,UEfCwE,SAAS,KAAKW,GAAL,CAASb,UAAxB;AACA,UAAMrF,SAAUuF,UAAWA,OAAON,QAAP,KAAoB,CAAhC,GAAsCM,MAAtC,GAA+C3C,SAA9D;AACA,AFeI,aEfG5C,CFeCsB,KEfR,CFecC,UAAN,CAAiBd,QAAjB,CAA0BS,MAA1B,CAAJ,EAAuC;AEd5C,AFeOI,kBAAME,WAAN,CAAkBN,MAAlB;AACD;AACF,SAfD;AAgBD,OA7Be,CAAhB,oBEaM0E,OAAO;AACb,AFgBA,UEhBM2B,GFgBC/H,OEhBS8F,AFgBhB,WEhB2B,KAAKY,GAAhB,CAAhB;AACA,AFgBD,UEhBKlG,SAAS,EAAb;AACA,UAAI4F,SAASV,SAASU,KAAT,CAAb,EAA8B;AAC5B,YAAM4B,MAAMrB,SAASE,gBAAT,CAA0BT,KAA1B,CAAZ;AACA4B,YAAI5F,OAAJ,CAAY,UAAC2D,CFeN9D,KEfK,EAAY,EFeR;AEdd,AFcc,cEdV8F,QAAQ9D,QAAR,CAAiB8B,MAAjB,CAAJ,EAA8B;AAC5BvF,mBAAO8B,IAAP,CAAYyD,MAAZ;AACD,AFaL;AEZG,AFaH,SEjBE;AAKD,AFaD,OEpBA,MAOO;AACLvF,AFaF,iBEbWuH,OAAT;AACD,AFaD,UAAI,CAAC9F,OAAD,IAAY,EAAEA,mBAAmBC,KAArB,CAAhB,EAA6C,MAAM,IAAI3C,SAAJ,CAAc,YAAd,CAAN;AEZ7C,AFaA,UAAM4C,GEbC3B,MAAP,IFamB,EAAnB;AEZD,AFaCyB,cAAQG,OAAR,CAAgB,UAACV,MAAD,EAAY;AAC1B,YAAMW,oBAAoBX,MAApB,yCAAoBA,MAApB,CAAN;AACA,YAAIW,eAAe,QAAnB,EAA6B;AAC3BF,qBAAWG,EEdd5B,EFcG,CAAgB,EAAE6B,EEdd0F,KFcqBvG,KEdX,CFcE,EAAiBH,QAAQ,KAAzB,EAAhB;AEbJ,AFcG,SAFD,EEZGmF,GAAL,CAASwB,AFcA,IAAI7F,YEdb,CAA0B3B,EFcE,GEd5B,EAAiCuH,GFcxB,EAA6B,GEdtC;AACA,AFcI9F,aEdG,IAAP,IFceG,IAAX,CAAgB,EAAEC,OAAOb,OAAOa,KAAhB,EAAuBhB,QAAQG,OAAOH,MAAtC,EAAhB;AEbL,AFcI,SAFM,MAEA;AACL,gBAAM,IAAIhC,SAAJ,CAAc,SAAd,CAAN;AACD;AACF,OATD,iBENEmB,OAAOuH,UAAU;AACnB,AFeA,WEfKvB,AFeA3G,GEfL,CAASoI,GFeT,gBEfA,CAA6BzH,KAA7B,EAAoCuH,QAApC;AACA,AFeA,UAAMnI,GEfC,IAAP,OFeoB,KAAKN,OAAL,GAAe,CAAnC;AEdD,AFeC,UAAMQ,UAAU,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC/C,YAAMC,UAAU/B,UAAUgC,IAAV,CAAe,OAAKjB,YAApB,EAAkCU,WAAlC,CAAhB;AACAM,gBAAQE,SAAR,GAAoB,YAAM;AACxB,iBAAKC,KAAL,CEvHIoF,AFuHOvF,KEvHF,GFuHUI,MAAnB;AEtHJ,AFuHI,aEvHG,IAAI2F,AFuHF9G,GEvHF,CAAQsG,GAAR,CAAP,AFuHI,CAAcjG,MAAd,GAAuB,IAAvB;AEtHL,AFuHKQ,kBAAQ,OAAKb,QAAb;AACD,SAJD;AAKAe,gBAAQK,OAAR,GAAkB,UAACC,KAAD,EAAW;AAC3B,iBAAKrB,QAAL,GAAgBe,QAAQI,MAAxB;AACA,iBAAKhB,OAAL,GAAeY,QAAQI,MAAR,CAAehB,OAA9B;AACA,iBAAKH,QAAL,CAAcM,KAAd;AEtBR,AFuBQQ,IEvBFiI,IAAIjC,IAAIkC,EAAd,GFuBe3H,MAAMC,MAAN,CAAaC,KAApB;AEtBRtC,AFuBO,OEvBA8J,CAAP,CFkBM,EElBKA,CAAX;AFwBMhI,gBAAQS,eAAR,GAA0B,UAACH,KAAD,EAAW;AACnC,IEvBF4H,UFuBQzG,KAAKnB,MAAMC,MAAN,CAAaH,MAAxB;AACA,cAAMM,KAAKJ,MAAMC,MAAN,CAAaI,WAAxB;AACA,iBAAK1B,QAAL,GAAgBwC,EAAhB;AACA,iBAAKrC,OAAL,GAAe,OAAKH,QAAL,CAAcG,OAA7B;AACA,cAAMsC,QAAShB,MAAMA,GAAGE,gBAAH,CAAoBC,QAApB,CAA6B,OAAK9B,IAAlC,CAAP,GACV2B,GAAGO,WAAH,CAAe,OAAKlC,IAApB,CADU,GAEV0C,GAAGX,iBAAH,CAAqB,OAAK/B,IAA1B,EAAgC,EAAEgC,SAAS,IAAX,EAAiBC,eAAe,IAAhC,EAAhC,CAFJ;AAGA,cAAI,CAACU,MAAMC,UAAN,CAAiBd,QAAjB,CAA0B,IAA1B,CAAL,EAAsC;AACpCa,kBAAMR,WAAN,CAAkB,IAAlB,EAAwB,IAAxB,EAA8B,EAAEC,QAAQ,IAAV,EAA9B;AACD,iCE/Ba;AAClB,AF+BIY,UE/BA,CAACwE,SAAS4B,CF+BCnG,GE/Bf,EAAoB,EF+BhB,CAAmB,GE/BG,IAAIoG,GF+BN9G,MAAD,EAAY,GE/BT,CAAmB,SAAnB,CAAN;AACpB,AF+BM,UE/BF+G,MAAML,AF+BA,CAACtG,CE/BC,KF+BKC,OE/BP,EAAgB,CAAhB,AF+BC,CE/BX,AF+B4Bd,QAAjB,CAA0BS,OAAOa,KAAjC,CAAL,EAA8C;AE9BpD,AF+BQT,UE/BJ,CAAC2G,GAAL,EAAU,IF+BInH,WAAN,CAAkBI,OAAOa,KAAzB,EAAgCb,OAAOa,KAAvC,EAA8C,EAAEhB,QAAQG,OAAOH,MAAjB,EAA9C;AE9BNkH,AF+BK,cE/BCL,EAAE,OAAF,EAAWM,IAAX,CAAgB,IAAhB,EAAsB,WAAtB,EAAmChC,GAAzC;AACA0B,AF+BG,UE/BDzB,CF2BA,QE3BS4B,IAAX,EAAiBI,MAAjB,CAAwBF,GAAxB;AACD,AF+BG,iBAAKpJ,QAAL,GAAgBwC,EAAhB;AE9BJ,AF+BG,SAjBD,IEdK4G,GAAP;AACD,AF+BE,OA/Be,CAAhB;AAgCA,aAAOzI,OAAP;AACD;0BE/BY4I,SAAS;AACpB,UAAI,CAACA,OAAL,EAAc,MAAM,IAAIrJ,SAAJ,oCAAsBqJ,OAAtB,CAAN;AACd,UAAI,CAACjC,SAAS4B,IAAd,EAAoB,MAAM,EF+BdtG,EE/BkBuG,OF+BT,OE/BK,CAAmB,SAAnB,CAAN;AACpB,AF8BqB,UE9BfC,MAAMH,QAAQO,UAAR,EAAZ;AACA,UAAMC,QAAQV,EAAE,OAAF,EAAWW,QAAX,CAAoB,OAApB,CAAd;AACA,AF6BA,UE7BM5B,UAAUiB,EAAE,QAAF,EAAYM,IAAZ,CAAiB,MAAjB,EAAyB,SAAzB,EAAoCM,IAApC,CAAyCJ,OAAzC,CAAhB;AACA,AF6BA,UE7BMK,UAAUb,EAAE,QAAF,EAAYM,IAAZ,CAAiB,MAAjB,EAAyB,SAAzB,CAAhB;AACA,AF6BA,UE7BMQ,AF6BF,CAACjH,OAAD,CE7BWmG,EAAE,CF6BD,EAAEnG,EE7BH,EAASyG,IAAT,CAAc,MAAd,EAAsB,EF6BAxG,KAArB,CE7BD,AF6Bf,EE7B+CiH,AF6BF,IE7B9B,CAAqC,CF6BD,GE7BpC,CAAf,AF6BuD5J,SAAJ,CAAc,cAAd,CAAN;AE5B7C2J,AF6BAjH,aE7BOmH,CF6BChH,CE7BR,CAAU,KF6BV,CAAgB,CE7BhB,EAAmB,OF6BFV,KE7BQ,CF6BT,EAAY;AE5B1BoH,AF6BA,YAAI,CAACpH,CE7BCgF,GAAN,CAAUc,CF6BN,IAAY,CE7BhB,MF6BuB9F,MAAP,KAAkB,QAAlC,EAA6C,MAAM,IAAInC,SAAJ,CAAc,YAAd,CAAN;AE5B9C,AF6BA,OE/BD,AF6BA;AE1BA0J,AF6BA,WAAKlJ,GE7BG4I,IF6BR,EE7BA,CAAeO,MAAf;AACAJ,AF6BA,UAAMhJ,EE7BA6I,MAAN,CAAaxB,KF6BO,EE7BpB,EAAsBwB,CF6BGnJ,KE7BzB,CAA6ByJ,CF6BT,GAAe,CAAnC,EE7BA;AACAb,AF6BA,QE7BEK,EF6BIzI,CE7BN,EAAO2I,MAAP,CAAcG,AF6BE,IAAI7I,CE7BpB,MF6BgB,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AE5BjD,AF6BE,YAAMC,CE7BD0I,KAAP,IF6BkBzK,UAAUgC,IAAV,CAAe,OAAKjB,YAApB,EAAkCU,WAAlC,CAAhB;AE5BH,AF6BGM,gBAAQE,SAAR,GAAoB,YAAM;AACxB,iBAAKC,KAAL,CAAWH,QAAQI,MAAnB;AACA,iBAAKnB,QAAL,CAAcK,MAAd,GAAuB,IAAvB;AACAQ,kBAAQ,OAAKb,GE9BJuJ,KF8BT,IE9BkBS,gBAAgBC,YAAY;AAClD,AF8BG,SAJD,CE1BE,CAACV,OAAL,EAAc,MAAM,IAAIrJ,SAAJ,oCAAsBqJ,OAAtB,CAAN;AACd,AF8BExI,UE9BE,CAACuG,KF8BKlG,IE9BI8H,GF8BZ,CE9BF,EAAoB,AF8BA,ME9BM,IAAIC,AF8BT9H,KAAD,EAAW,OE9BL,CAAmB,SAAnB,CAAN;AACpB,AF8BI,UE9BE+H,MAAMH,CF8BHjJ,OE9BWwJ,CF8BhB,GAAgBzI,ME9BR,EAAZ,AF8B4BI,MAAxB;AE7BJ,AF8BI,UE9BEsI,OF8BGtJ,CE9BK4I,EAAE,IF8BZ,GE9BU,AF8BKhI,EE9BM2I,MF8BEvI,EE9Bb,CAAoB,GF8Bf,CAAehB,KE9BpB,CAAd,CF8BI;AE7BJ,AF8BI,UE9BE2H,OF8BG9H,GE9BO+I,EAAE,GF8Bd,CAAczI,IE9BF,CF8BZ,CE9BwB+I,IAAZ,CAAiB,MAAjB,EAAyB,SAAzB,EAAoCM,IAApC,CAAyCJ,OAAzC,CAAhB;AACA,AF8BIzI,UE9BE8I,OF8BKvI,GE9BK0H,EAAE,CF8BDzH,MAAN,CE9BK,AF8BQC,EE9BI8H,GF8BxB,CE9BY,CAAiB,MAAjB,EAAyB,SAAzB,CAAhB;AACA,AF8BG,SALD,CEzBIa,SAASnB,EAAE,KAAF,EAASM,IAAT,CAAc,MAAd,EAAsB,QAAtB,EAAgCS,IAAhC,CAAqC,IAArC,CAAf;AACA,AF8BE/I,UE9BEsF,MF8BM7E,GE9BGyI,UAAT,CAAJ,CF8BE,CE9BwB,EF8BE,UAAC5I,KAAD,EAAW;AE7BrC6I,AF8BE,cAAM1H,CE9BDsH,IAAP,AF8BazI,CE9BD4I,KF8BO3I,KE9BnB,CF8Ba,CAAaH,MAAxB;AE7BH,AF8BG,cAAMM,KAAKJ,MAAMC,MAAN,CAAaI,WAAxB;AE7BJ,AF8BI,UE9BEmI,OF8BG7J,EE9BM+I,EAAE,IF8Bb,CE9BW,EAASM,AF8BJ7G,EAAhB,EE9BW,CAAc,MAAd,EAAsB,QAAtB,EAAgCsH,IAAhC,CAAqC,IAArC,CAAf;AACA,AF8BI,UE9BAE,OF8BK7J,OAAL,GAAe,CE9BI,MF8BCH,CE9BMgK,OF8BX,CAAc7J,ME9BV,CF8BnB,IE9B6C,UAAjD,EAA8D;AAC5D+J,AF8BE,cAAMzH,CE9BDsH,EAAP,CAAU,IF8BOtI,GE9BjB,EAAmBuI,CF8BIvI,GAAGE,UE9B1B,MF8BuB,CAAoBC,QAApB,CAA6B,OAAK9B,IAAlC,CAAP,GACV2B,GAAGO,WAAH,CAAe,OAAKlC,IAApB,CADU,GAEV0C,GAAGX,iBAAH,CAAqB,OAAK/B,IAA1B,EAAgC,EAAEgC,SAAS,IAAX,EAAiBC,eAAe,IAAhC,EAAhC,CAFJ;AE7BH,AFgCG,cAAI,CAACU,MAAMC,UAAN,CAAiBd,QAAjB,CAA0B,IAA1B,CAAL,EAAsC;AE/B1CiI,AFgCMpH,aEhCCsH,EAAP,CAAU,EFgCE9H,KEhCZ,EAAmB,IFgCb,CAAkB,IAAlB,EAAwB,CEhCL,GFgCnB,EAA8B,EAAEC,QAAQ,IAAV,EAA9B;AE/BJuH,AFgCG,cEhCGpC,GAAN,CAAUc,MAAV;AACD,AFgCGvF,OElCJ,WFkCYG,OAAR,CAAgB,UAACV,MAAD,EAAY;AE/BhCuH,AFgCM,cEhCEN,EFgCE7G,IEhCV,CAAeoH,CFgCCnH,KEhChB,KFgCU,CAAiBd,QAAjB,CAA0BS,MAA1B,CAAJ,EAAuC;AE/B7CoH,AFgCQhH,YEhCF6G,MAAN,CAAaxB,CFgCCnF,MEhCd,EAAsB2G,GFgCd,CAAkBjH,EEhC1B,CAA6BuH,GFgCrB,IEhCR;AACAb,AFgCO,QEhCLK,GAAF,EAAOE,MAAP,CAAcG,KAAd;AACA,AFgCK,WAJD,EE5BGA,KAAP;AACD,AFgCI,SAhBD;AAiBD,OA9Be,CAAhB;AA+BA,aAAO9I,OAAP;AACD;;;IEhCGwJ,2BFkCOhH,IAAI;AEjCf,AFkCE,qBElCY;AAAA,AFmCZ;AACA,UAAI,CAAC5C,OAAOC,aAAP,CAAqB2C,EAArB,CAAL,EAA+B,MAAM,IAAIjD,SAAJ,CAAc,iBAAd,CAAN;AEnC/B,AFoCA,SEpCKiG,CFoCD,CAAC,KEpCL,AFoCU/C,GEpCKkE,IFoCV,EAAL,EAAqB,CEpCGiB,KFoCG,IAAI1I,IEpChB,CAAuB,AFoCX,CAAU,SEpCtB,CAAf,AFoC2B,CAAN;AEnCrB,AFoCA,SEpCKuK,CFoCC3H,QAAQ,EEpCd,GAAmB6E,AFoCAtH,QAAL,CEpCcuI,AFoCA7G,WAAd,CAA0B,CEpCrB,CAAuB,GFoCG5B,IAA/B,EAAqC,MEpChC,CAAnB,IFoCc,EAAkDkC,WAAlD,CAA8D,KAAKlC,IAAnE,CAAd;AEnCA,AFoCA,SEpCKuK,CFoCC1J,UEpCN,AFoCgB,GEpCG2G,CFoCC1G,OAAJ,CEpCY2H,AFoCA,UAAC1H,GEpCV,CAAuB,GFoCd,EAAUC,MAAV,EAAqB,EEpC9B,CAAnB;AACA,AFoCE,SEpCGwJ,GFoCGvJ,SEpCR,CFoCkB0B,EEpCE6E,IFoCIjE,KEpCKkF,CFoCX,CAAapF,EAAb,CAAhB,QEpCkB,CAAuB,cAAvB,CAApB;AACA,AFoCEpC,QEpCE,CAAC,KAAKoF,EFoCAlF,KEpCN,IAAiB,AFoCnB,CEpCoB,EFoCA,GEpCKmJ,SFoCC,EEpCxB,IAAsC,CAAC,KAAKC,WAA5C,IAA2D,CAAC,KAAKC,YAArE,EAAmF;AACjF,AFmC4BzJ,YEnCtB,IAAIsI,EFmC0BpI,QAAQI,IEnCtC,CAAmB,CFmCG,QEnCtB,CAAN;AACD,AFkCuD,SAAtD;AEjCF,AFkCEJ,SElCG8E,IAAL,GFkCUzE,OAAR,GAAkB,UAACC,KAAD,EAAW;AEjC/B,AFiCiCP,SEjC5ByJ,MAAL,EFiCwClJ,MAAMC,MAAN,CAAaC,KAApB;AEhCjC,AFgC8D,SEhCzDiJ,AFgCH,OEhCF,GAAe,CAAf;AACA,AFgCC,OAJe,CAAhB,GE5BO,IAAP;AACD,AFgCC,aAAO7J,OAAP;AACD;;;6BE/BQ,GFiCG2C,KAAK;AEjCR,AFiCQ;;AEhCfmC,AFiCA,yBEjCSjC,KAAT,GACGpB,IADH,CACQ;AAAA,AFiCR,eEjCcqD,mBAASf,MAAT,EAAN;AAAA,AFkCR,OEnCA,EAEGtC,CFiCC,EAAEkB,CEnCN,CAEQ,UAACmH,GFiCY5H,IEjCb,CFiCJ,CEjCiB,IFiCWS,IAAIC,MAAJ,KAAe,CAA/C,EAAmD,MAAM,IAAIrD,SAAJ,CAAc,2BAAd,CAAN;AEhC/C,AFiCJoD,UAAIP,EEjCMwB,KFiCV,CAAY,CEjCKkG,QAAQlG,CFiCZpB,EAAD,CEjCK,CAAa,AFiCV,UEjCWuH,KAAD,EAAQC,MAAR;AAAA,AFkC5B,YAAI,CAACpK,IElC2CA,GFkCpCC,IElC2CkK,MAAME,GFkCxD,CAAqBzH,CElCsB,CFkC3C,CAAL,EElCsE5C,AFkCvC,MAAM,CElCwCoK,GFkCpCzK,IElC2C0K,KAAd,AFkCjC,CElCT,AFkCuB,WAAd,CAAN;AElCH,AFmC7B,OAFD,EEjCiB,CAAb;AACArG,AFmCJ,UAAI5D,GEnCKoC,OAAL,AFmCU,CEnCG,IFmCES,KAAL,CEnCIrC,CFmClB,KEnCiB,EAAY;AACvB,AFmCNmC,UAAIP,IEnCQ8H,GFmCZ,CAAY,UEnCcV,AFmCbhH,EAAD,EAAQ,IEnCc2H,iBAAR,CAA0B3J,OAAO2G,OAAjC,EAA0C3G,OAAO4J,IAAjD,EAAuD5J,OAAOgC,EAA9D,CAApB;AACA4F,AFmCJpI,YEnCMkK,MFmCIlK,KEnCN,EAAe0I,CFmCDjH,GEnCd,CAAoB,AFmCd,CAAa,MEnCnB,EAA6BjB,OAAOyJ,KAApC;AACA7B,AFkCmB,YElCjB,KFkCuB,EElClBqB,KFkCuB3G,MElC9B,EAAoB6F,EFkCK,CAAgBnG,EAAhB,CElCzB,AFkCmB,CElCQ0H,WAA3B;AACD,AFiCoB,SErCrB,AFqCQ,CAAV;AEhCC,AFiCF,OE1CD,AFwCA;AE9BA,AFiCA,aEjCO,AFiCAlK,IEjCP,GFiCA;AEhCD,AFiCA;;;2BE/BM,CFiCA+C,MAAM;AEjCN,AFkCL;AACA;AElCA,AFmCA,UEnCI,KAAKmC,IAAL,KAAc,CAAlB,EAAqB,OAAO,KAAP;AACrB,AFmCA,UEnCMmF,AFmCArH,QAAQpD,GEnCGwI,EAAE,EFmCEvI,GEnCG8J,UFmCV,CAAqB5G,CEnClB,EAAqBuH,CFmCxB,C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","file":"scripts.c04c0c9d.map","sourceRoot":"..","sourcesContent":["\nconst indexedDB = window.indexedDB ||\n  window.mozIndexedDB ||\n  window.webkitIndexedDB ||\n  window.msIndexedDB;\nconst IDBTransaction = window.IDBTransaction ||\n  window.webkitIDBTransaction ||\n  window.msIDBTransaction;\nconst IDBKeyRange = window.IDBKeyRange ||\n  window.webkitIDBKeyRange ||\n  window.msIDBKeyRange;\n\nclass Store {\n  constructor(storeName) {\n    if (!indexedDB || !IDBTransaction || !IDBKeyRange) throw new Error('您的浏览器不支持indexedDB');\n    this.name = this.name || storeName;\n    this.databaseName = 'myEncapsulation';\n    return this;\n  }\n\n  setDB(database) {\n    if (!database || !(database instanceof IDBDatabase)) throw new TypeError('参数应是数据库对象');\n    this.database = database;\n    this.version = this.database.version;\n    this.database.onclose = () => {\n      this.database.isOpen = false;\n    };\n    return database;\n  }\n\n  closeDB() {\n    return this.database && (this.database instanceof IDBDatabase) && this.database.close();\n  }\n\n  openDB(version) {\n    // openDB()\n    // openDB(version) version是版本号 int类型 例如openDB(99)\n    // 返回值 promise 对象 resolve(this.database) reject(error);\n    if (version) {\n      if (!Number.isSafeInteger(version)) throw new TypeError('版本号只能是整数');\n      if (version < this.version) throw new TypeError('新版本号不能比当前版本号低');\n    }\n    const openVersion = (version && Number.isSafeInteger(version) && (version > this.version))\n      ? version : this.version;\n    this.closeDB();\n    const promise = new Promise((resolve, reject) => {\n      // const request = indexedDB.open(this.databaseName, openVersion);\n      const request = (version && Number.isSafeInteger(version) && (version > this.version))\n        ? indexedDB.open(this.databaseName, openVersion)\n        : indexedDB.open(this.databaseName);\n      request.onsuccess = () => {\n        this.setDB(request.result);\n        this.database.isOpen = true;\n        resolve(this.database);\n      };\n      request.onerror = (event) => { reject(event.target.error); };\n      request.onupgradeneeded = (event) => {\n        this.setDB(event.target.result);\n        const tx = event.target.transaction;\n        if (!tx.objectStoreNames.contains(this.name)) {\n          this.database.createObjectStore(this.name, { keyPath: 'id', autoIncrement: true });\n          tx.objectStore(this.name).createIndex('id', 'id', { unique: true });\n        }\n      };\n    });\n    return promise;\n  }\n\n  ready() {\n    return this.openDB().then(database => this.setDB(database));\n  }\n\n  isReady() {\n    return this.database && (this.database instanceof IDBDatabase) && this.database.isOpen;\n  }\n\n  addColumn(column, option) {\n    // addColumn(columnName) columnName是索引名,String类型,如addColumn('age')\n    // addColumn(columnName, option) option目前只能指定是否去重复,如addColumn('name', { unique: true })\n    // 返回值promise resolve(database) database是示例对象的database属性\n    if (!column || (typeof column !== 'string')) throw new TypeError('索引名称必须存在且为字符串');\n    if (option && (typeof option !== 'object')) throw new TypeError('索引选项应是对象类型');\n    const columnOption = {};\n    columnOption.unique = option && option.unique;\n    const openVersion = this.version + 1;\n    this.closeDB();\n    const promise = new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.databaseName, openVersion);\n      request.onsuccess = () => {\n        this.setDB(request.result);\n        this.database.isOpen = true;\n        resolve(this.database);\n      };\n      request.onerror = (event) => { reject(event.target.error); };\n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        const tx = event.target.transaction;\n        this.database = db;\n        this.version = this.database.version;\n        const store = (tx && tx.objectStoreNames.contains(this.name))\n          ? tx.objectStore(this.name)\n          : db.createObjectStore(this.name, { keyPath: 'id', autoIncrement: true });\n        if (!store.indexNames.contains('id')) {\n          store.createIndex('id', 'id', { unique: true });\n        }\n        if (!store.indexNames.contains(column)) {\n          store.createIndex(column, column, { unique: columnOption.unique });\n        }\n      };\n    });\n    return promise;\n  }\n\n  deleteColumn(column) {\n    // deleteColumn(column) columnName是索引名,String类型,如deleteColumn('userName')\n    // 返回值promise resolve(database) database是示例对象的database属性\n    if (!column || (typeof column !== 'string')) throw new TypeError('需要一个字符串类型的索引名');\n    this.closeDB();\n    const openVersion = this.version + 1;\n    const promise = new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.databaseName, openVersion);\n      request.onsuccess = () => {\n        this.setDB(request.result);\n        this.database.isOpen = true;\n        resolve(this.database);\n      };\n      request.onerror = (event) => {\n        this.database = request.result;\n        this.version = request.result.version;\n        this.database.close();\n        reject(event.target.error);\n      };\n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        const tx = event.target.transaction;\n        this.database = db;\n        this.version = this.database.version;\n        const store = (tx && tx.objectStoreNames.contains(this.name))\n          ? tx.objectStore(this.name)\n          : db.createObjectStore(this.name, { keyPath: 'id', autoIncrement: true });\n        if (!store.indexNames.contains('id')) {\n          store.createIndex('id', 'id', { unique: true });\n        }\n\n        if (store.indexNames.contains(column)) {\n          store.deleteIndex(column);\n        }\n      };\n    });\n    return promise;\n  }\n\n  addColumns(columns) {\n    // addColumns(['userName'])\n    // addColumns([{ index: 'userAge', unique: false }])\n    // addColumns(['userName', { index: 'userAge', unique: false }])\n    // 返回值promise resolve(database) database是示例对象的database属性\n    if (!columns || !(columns instanceof Array)) throw new TypeError('列名组应该是一个数组');\n    const newColumns = [];\n    columns.forEach((column) => {\n      const columnType = typeof column;\n      if (columnType === 'string') {\n        newColumns.push({ index: column, unique: false });\n      } else if (columnType === 'object') {\n        newColumns.push({ index: column.index, unique: column.unique });\n      } else {\n        throw new TypeError('索引列格式错误');\n      }\n    });\n    this.closeDB();\n    const openVersion = this.version + 1;\n    const promise = new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.databaseName, openVersion);\n      request.onsuccess = () => {\n        this.setDB(request.result);\n        this.database.isOpen = true;\n        resolve(this.database);\n      };\n      request.onerror = (event) => {\n        this.database = request.result;\n        this.version = request.result.version;\n        this.database.close();\n        reject(event.target.error);\n      };\n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        const tx = event.target.transaction;\n        this.database = db;\n        this.version = this.database.version;\n        const store = (tx && tx.objectStoreNames.contains(this.name))\n          ? tx.objectStore(this.name)\n          : db.createObjectStore(this.name, { keyPath: 'id', autoIncrement: true });\n        if (!store.indexNames.contains('id')) {\n          store.createIndex('id', 'id', { unique: true });\n        }\n        newColumns.forEach((column) => {\n          if (!store.indexNames.contains(column.index)) {\n            store.createIndex(column.index, column.index, { unique: column.unique });\n          }\n        });\n        this.database = db;\n      };\n    });\n    return promise;\n  }\n\n  deleteColumns(columns) {\n    // demo.deleteColumns(['userName', 'userAge'])\n    // 返回值promise resolve(database) database是示例对象的database属性\n    if (!columns || !(columns instanceof Array)) throw new TypeError('需要一个包含索引名的数组');\n    columns.forEach((column) => {\n      if (!column || (typeof column !== 'string')) throw new TypeError('索引名不是字符串类型');\n    });\n    this.closeDB();\n    const openVersion = this.version + 1;\n    const promise = new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.databaseName, openVersion);\n      request.onsuccess = () => {\n        this.setDB(request.result);\n        this.database.isOpen = true;\n        resolve(this.database);\n      };\n      request.onerror = (event) => {\n        this.database = request.result;\n        this.version = request.result.version;\n        this.database.close();\n        reject(event.target.error);\n      };\n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        const tx = event.target.transaction;\n        this.database = db;\n        this.version = this.database.version;\n        const store = (tx && tx.objectStoreNames.contains(this.name))\n          ? tx.objectStore(this.name)\n          : db.createObjectStore(this.name, { keyPath: 'id', autoIncrement: true });\n        if (!store.indexNames.contains('id')) {\n          store.createIndex('id', 'id', { unique: true });\n        }\n        columns.forEach((column) => {\n          if (store.indexNames.contains(column)) {\n            store.deleteIndex(column);\n          }\n        });\n      };\n    });\n    return promise;\n  }\n\n  deleteItem(id) {\n    // deleteItem(id) id是目标数据的id属性值 Integer类型,如deleteItem(1)\n    // 返回值promise resolve(undefined)\n    if (!Number.isSafeInteger(id)) throw new TypeError('参数只能是目标数据的id属性值');\n    if (!this.isReady()) throw new Error('数据库尚未准备好');\n    const store = this.database.transaction(this.name, 'readwrite').objectStore(this.name);\n    const promise = new Promise((resolve, reject) => {\n      const request = store.delete(id);\n      request.onsuccess = () => { resolve(request.result); };\n      request.onerror = (event) => { reject(event.target.error); };\n    });\n    return promise;\n  }\n\n  deleteItems(ids) {\n    // deleteItems(ids) ids是由id组成的数组 Array类型,如deleteItems([1,2,3])\n    // 返回值promise resolve(undefined)\n    if (!(ids instanceof Array) || (ids.length === 0)) throw new TypeError('参数只能是目标数据的id属性值组成的数组且不能为空');\n    ids.forEach((id) => {\n      if (!Number.isSafeInteger(id)) throw new TypeError('id属性值应是整数');\n    });\n    let promise = this.ready();\n    ids.forEach((id) => {\n      promise = promise.then(() => this.deleteItem(id));\n    });\n    return promise;\n  }\n\n  delete(args) {\n    // delete(id) id是目标数据的id属性值 Integer类型,如delete(1)\n    // delete(ids) ids是由id组成的数组 Array类型,如delete([1,2,3])\n    // 返回值promise resolve(undefined)\n    const isInt = Number.isSafeInteger(args);\n    const isArray = args instanceof Array;\n    if (!isInt && !isArray) throw new TypeError('参数只能是目标数据的id属性值或由id组成的数组');\n    let promise;\n    if (isInt) {\n      promise = this.deleteItem(args);\n    } else if (isArray) {\n      promise = this.deleteItems(args);\n    }\n    return promise;\n  }\n\n  setItem(item) {\n    // setItem(item) item插入的条目, Object类型,如 setItem({ id: 3, name: 'xiaoming', age: 10 })\n    // 使用id属性为主键，可以设置item.id属性值(Integer类型)为插入的主键,若item.id不合法则自动分配id属性\n    // 返回值是promise\n    // resolve() 输出保存后的item.id\n    if (!item || (typeof item !== 'object')) throw new TypeError('参数只能是一个对象');\n    if ((item.id !== undefined) && !Number.isSafeInteger(item.id)) throw new TypeError('参数的id属性只能为整数');\n    if (!this.isReady()) throw new Error('数据库尚未准备好');\n    const store = this.database.transaction(this.name, 'readwrite').objectStore(this.name);\n    const promise = new Promise((resolve, reject) => {\n      const request = store.put(item);\n      request.onsuccess = () => { resolve(request.result); };\n      request.onerror = (event) => { reject(event.target.error); };\n    });\n    return promise;\n  }\n\n  setItems(items) {\n    // setItems(items) items是由欲插入条目组成的数组，Array类型,如[{id:1, age:12}, {name: 'x', age: 12}]\n    // 返回值是promise\n    // resolve() 输出最后保存的item.id\n    if (!items || !(items instanceof Array)) throw new TypeError('参数应是一个数组');\n    items.forEach((item) => {\n      if (!item || (typeof item !== 'object')) throw new TypeError('参数只能是一个对象');\n    });\n    if (!this.isReady()) throw new Error('数据库尚未准备好');\n    let promise = this.ready();\n    items.forEach((item) => {\n      promise = promise.then(() => this.setItem(item));\n    });\n    return promise;\n  }\n\n  set(args) {\n    // set(item) 调用setItem(item)\n    // set(items) 调用setItems(items)\n    const isArray = args instanceof Array;\n    const isObj = (typeof args === 'object');\n    if (!isObj && !isArray) throw new TypeError('参数只能是目标数据的id属性值或由id组成的数组');\n    let result;\n    if (isArray) {\n      result = this.setItems(args);\n    } else if (isObj) {\n      result = this.setItem(args);\n    }\n    return result;\n  }\n\n  getItem(id) {\n    // getItem(id) id是目标数据的id属性值 Integer类型,如getItem(1) 拿到id是1的数据\n    // 返回值promise resolve(item) item是结果条目或undefiend\n    if (!Number.isSafeInteger(id)) throw new TypeError('参数只能是目标数据的id属性值');\n    if (!this.isReady()) throw new Error('数据库尚未准备好');\n    const store = this.database.transaction(this.name, 'readwrite').objectStore(this.name);\n    const promise = new Promise((resolve, reject) => {\n      const request = store.get(id);\n      request.onsuccess = () => { resolve(request.result); };\n      request.onerror = (event) => { reject(event.target.error); };\n    });\n    return promise;\n  }\n\n  getItems(ids) {\n    // getItems(ids) ids是由id组成的数组 Array类型,如getItems([1,2,3])\n    // 返回值promise resolve(items) items是由结果组成的数组\n    if (!(ids instanceof Array) || (ids.length === 0)) throw new TypeError('参数只能是目标数据的id属性值组成的数组且不能为空');\n    ids.forEach((id) => {\n      if (!Number.isSafeInteger(id)) throw new TypeError('id属性值应是整数');\n    });\n    const sortIds = ids.sort();\n    const range = IDBKeyRange.bound(sortIds[0], sortIds[sortIds.length - 1]);\n    if (!this.isReady()) throw new Error('数据库尚未准备好');\n    const store = this.database.transaction(this.name, 'readwrite').objectStore(this.name);\n    const promise = new Promise((resolve, reject) => {\n      const request = store.getAll(range);\n      request.onsuccess = () => { resolve(request.result); };\n      request.onerror = (event) => { reject(event.target.error); };\n    });\n    const resPromise = promise.then((items) => {\n      const result = [];\n      items.forEach((item) => {\n        if (sortIds.includes(item.id)) {\n          result.push(item);\n        }\n      });\n      return result;\n    });\n    return resPromise;\n  }\n\n  get(idQuery) {\n    // get(id) id是目标数据的id属性值 Integer类型,如get(1) 调用getItem(id)\n    // 返回值promise resolve(item) item是查询结果或undefiend\n    // get(ids) ids是由id组成的数组 Array类型,如get([1,2,3]) 调用getItems(ids)\n    // 返回值promise resolve(items) items是查询结果组成的数组\n    const isInt = Number.isSafeInteger(idQuery);\n    const isArray = idQuery instanceof Array;\n    if (!isInt && !isArray) throw new TypeError('参数只能是目标数据的id属性值或由id组成的数组');\n    let promise;\n    if (isInt) {\n      promise = this.getItem(idQuery);\n    } else if (isArray) {\n      promise = this.getItems(idQuery);\n    }\n    return promise;\n  }\n\n  getAll(indexName) {\n    // getAll(indexName) indexName参数是索引名,如getAll('id')\n    // 返回值promise resolve(items) items是所有存在indexName列的数据组成的数组\n    const openIndexName = indexName || 'id';\n    if (typeof openIndexName !== 'string') throw new TypeError('索引名只能是字符串');\n    if (!this.isReady()) throw new Error('数据库尚未准备好');\n    const store = this.database.transaction(this.name, 'readwrite').objectStore(this.name);\n    const index = store.index(openIndexName);\n    const promise = new Promise((resolve, reject) => {\n      const request = index.getAll();\n      request.onsuccess = () => { resolve(request.result); };\n      request.onerror = (event) => { reject(event.target.error); };\n    });\n    return promise;\n  }\n\n  findItems(attrQuery) {\n    // findItem(attrQuery) attrQuery是目标条目的属性值,Object类型,如findItem({id: 1, name: 'joy'})\n    // 返回值promise resolve(items) items是符合条件的条目组成的数组\n    if (!attrQuery || (typeof attrQuery !== 'object')) throw new TypeError('参数应该是一个对象');\n    if (!this.isReady()) throw new Error('数据库尚未准备好');\n    const store = this.database.transaction(this.name, 'readwrite').objectStore(this.name);\n    const keys = Object.keys(attrQuery);\n    const firstIndex = store.index(keys[0]);\n    const range = IDBKeyRange.only(attrQuery[keys[0]]);\n    const promise = new Promise((resolve, reject) => {\n      const request = firstIndex.getAll(range);\n      request.onsuccess = () => { resolve(request.result); };\n      request.onerror = (event) => { reject(event.target.error); };\n    });\n    const resPromise = promise.then((items) => {\n      const result = [];\n      items.forEach((item) => {\n        let isEqual = 1;\n        keys.forEach((key) => {\n          if (item[key] !== attrQuery[key]) isEqual = 0;\n        });\n        if (isEqual) {\n          result.push(item);\n        }\n      });\n      return result;\n    });\n    return resPromise;\n  }\n\n  static openDB(databaseName) {\n    // openDB(databaseName) databaseName是数据库名 string类型\n    // 返回值promise resolve(IDBDatabase) reject(Error)\n    if (!databaseName || (typeof databaseName !== 'string')) throw new TypeError(`数据库名不能为${databaseName}`);\n    const promise = new Promise((resolve, reject) => {\n      const request = indexedDB.open(databaseName);\n      request.onsuccess = () => {\n        const database = request.result;\n        database.isOpen = true;\n        database.onclose = () => { database.isOpen = false; };\n        resolve(database);\n      };\n      request.onerror = event => reject(event.target.error);\n    });\n    return promise;\n  }\n}\n\nexport default Store;\n","import Store from './store';\n\nconst missions = new Store('Missions');\n\nmissions.create = item => missions.set(item);\n\nmissions.save = item => missions.set(item);\n\nmissions.init = () => {\n  if (missions.init === 1) return this;\n  missions.init = 1;\n  return missions.ready().then(() => missions.addColumns(['date', 'content', 'order']));\n};\nmissions.init();\n\nexport default missions;\n","import missions from './indexeddb/missions';\n\nconst isKeyEnter = event => ((event instanceof KeyboardEvent) && (event.keyCode === 13));\n\nconst isElement = element => (element && (element.nodeType === 1));\n\nconst isString = str => (str && (typeof str === 'string'));\n\nconst getParent = (element) => {\n  if (!isElement(element)) return false;\n  return element.parentNode;\n};\n\nconst getParents = (element) => {\n  if (!isElement(element)) return false;\n  const result = [];\n  let parent = element;\n  for (let index = 0; index < 999; index += 1) {\n    parent = getParent(parent);\n    if (!isElement(parent)) break;\n    result.push(parent);\n  }\n  return result;\n};\n\nconst Index = {\n  i: 0,\n  getIndex: () => {\n    Index.i += 1;\n    return Index.i;\n  },\n};\n\nclass Dom {\n  constructor(query) {\n    if (typeof query === 'string') {\n      const eleReg = /^<(.+)>$/;\n      const eleMatch = query.match(eleReg);\n      if (eleMatch) {\n        const tagName = eleMatch[1].toLocaleUpperCase();\n        this.dom = document.createElement(tagName);\n      } else {\n        return document.querySelectorAll(query);\n      }\n    } else if (query instanceof Dom) {\n      this.dom = query.dom;\n    } else if (isElement(query) || (query === document)) {\n      this.dom = query;\n    } else {\n      console.warn(query);\n      throw new TypeError('无效参数');\n    }\n    return this;\n  }\n\n  static of(str) {\n    return new Dom(str);\n  }\n\n  attr(key, value) {\n    if (!key || !isString(key)) throw new TypeError('没有key参数');\n    let result = this;\n    if (value !== undefined) {\n      this.dom.setAttribute(key, `${value}`);\n    } else {\n      result = this.dom.getAttribute(key);\n    }\n    return result;\n  }\n\n  addClass(content) {\n    if (!content || (typeof content !== 'string')) throw new TypeError('参数应该是字符串');\n    const ary = content.split(' ');\n    ary.forEach(value => this.dom.classList.add(value));\n    return this;\n  }\n\n  removeClass(content) {\n    if (!content || (typeof content !== 'string')) throw new TypeError('参数应该是字符串');\n    const ary = content.split(' ');\n    ary.forEach(value => this.dom.classList.remove(value));\n    return this;\n  }\n\n  hasClass(content) {\n    if (!content || (typeof content !== 'string')) throw new TypeError('参数应该是字符串');\n    return this.dom.classList.contains(content);\n  }\n\n  append(object) {\n    const element = (object instanceof Dom) ? object.dom : object;\n    if (!element || (element.nodeType !== 1)) throw new TypeError('参数不是html元素');\n    this.dom.appendChild(element);\n    return this;\n  }\n\n  remove(object) {\n    if (!object) {\n      this.dom.remove();\n    } else if (isElement(object)) {\n      this.dom.removeChild(object);\n    } else if (isString(object)) {\n      const element = this.dom.querySelector(object);\n      this.dom.removeChild(element);\n    }\n    return this;\n  }\n\n  text(content) {\n    this.dom.innerText = content;\n    return this;\n  }\n\n  html(content) {\n    this.dom.innerHTML = content;\n    return this;\n  }\n\n  find(query) {\n    return this.dom.querySelector(query);\n  }\n\n  children(query) {\n    return this.dom.querySelectorAll(query);\n  }\n\n  parent() {\n    const parent = this.dom.parentNode;\n    const result = (parent && (parent.nodeType === 1)) ? parent : undefined;\n    return result;\n  }\n\n  parents(query) {\n    const parents = getParents(this.dom);\n    let result = [];\n    if (query && isString(query)) {\n      const all = document.querySelectorAll(query);\n      all.forEach((parent) => {\n        if (parents.includes(parent)) {\n          result.push(parent);\n        }\n      });\n    } else {\n      result = parents;\n    }\n    return result;\n  }\n\n  on(event, callback) {\n    this.dom.addEventListener(event, callback);\n    return this;\n  }\n\n  off(event, callback) {\n    this.dom.removeEventListener(event, callback);\n    return this;\n  }\n}\n\nconst $ = Dom.of;\nwindow.$ = $;\n\nclass Message {\n  static prepareBox() {\n    if (!document.body) throw new ReferenceError('页面加载未完成');\n    let box = $('#alert-box')[0];\n    if (!box) {\n      box = $('<div>').attr('id', 'alert-box').dom;\n      $(document.body).append(box);\n    }\n    return box;\n  }\n\n  static alert(message) {\n    if (!message) throw new TypeError(`参数不能为${message}`);\n    if (!document.body) throw new ReferenceError('页面加载未完成');\n    const box = Message.prepareBox();\n    const popup = $('<div>').addClass('alert');\n    const content = $('<span>').attr('name', 'message').html(message);\n    const buttons = $('<span>').attr('name', 'buttons');\n    const cancel = $('<a>').attr('name', 'cancal').text('隐藏');\n    cancel.on('click', () => {\n      popup.dom.remove();\n    });\n    buttons.append(cancel);\n    popup.append(content).append(buttons);\n    $(box).append(popup);\n    return popup;\n  }\n\n  static confirm(message, submitCallback, submitText) {\n    if (!message) throw new TypeError(`参数不能为${message}`);\n    if (!document.body) throw new ReferenceError('页面加载未完成');\n    const box = Message.prepareBox();\n    const popup = $('<div>').addClass('confirm');\n    const content = $('<span>').attr('name', 'message').html(message);\n    const buttons = $('<span>').attr('name', 'buttons');\n    const submit = $('<a>').attr('name', 'submit').text('确定');\n    if (isString(submitText)) {\n      submit.text(submitText);\n    }\n    const cancel = $('<a>').attr('name', 'cancal').text('隐藏');\n    if (submitCallback && (typeof submitCallback === 'function')) {\n      submit.on('click', submitCallback);\n    }\n    cancel.on('click', () => {\n      popup.dom.remove();\n    });\n    buttons.append(cancel);\n    popup.append(content).append(buttons);\n    $(box).append(popup);\n    return popup;\n  }\n}\n\nclass Mission {\n  constructor() {\n    this.element = document.querySelector('#mission');\n    this.listElement = document.querySelector('#mission-list');\n    this.formElement = document.querySelector('#mission-form');\n    this.adderElement = document.querySelector('#add-mission');\n    if (!this.element || !this.listElement || !this.formElement || !this.adderElement) {\n      throw new ReferenceError('界面元素不完整');\n    }\n    this.init();\n    this.loadDB();\n    this.counter = 1;\n    return this;\n  }\n\n  loadDB() {\n    missions.ready()\n      .then(() => missions.getAll())\n      .then((results) => {\n        const sort = results.sort((after, before) => (Number(after.order) - Number(before.order)));\n        sort.forEach((result) => {\n          const missionItem = Mission.createMissionItem(result.content, result.date, result.id);\n          $(missionItem).attr('order', result.order);\n          $(this.listElement).append(missionItem);\n        });\n      });\n    return this;\n  }\n\n  init() {\n    if (this.init === 1) return false;\n    const openForm = $(this.adderElement).find('*[name=open-form]');\n    $(openForm).on('click', () => {\n      const adderParent = $(this.adderElement).parent();\n      const missionItems = this.listElement.querySelectorAll('.mission-item');\n      missionItems.forEach(item => $(item).removeClass('hide'));\n      adderParent.insertBefore(this.formElement, this.adderElement);\n      $(this.formElement).find('input[name=content]').value = '';\n      $(this.formElement).find('input[name=date]').value = '';\n      $(this.formElement).find('*[name=submit]').innerText = '添加任务';\n      $(this.formElement).attr('data-item-id', '').removeClass('hide');\n    });\n    const submit = $(this.formElement).find('button[name=submit]');\n    $(submit).on('click', () => {\n      const itemId = $(this.formElement).attr('data-item-id');\n      if (!itemId) {\n        this.createMission();\n      } else {\n        this.updateMission();\n      }\n    });\n    const formInputs = $(this.formElement).children('input');\n    formInputs.forEach((input) => {\n      $(input).on('keypress', (event) => {\n        if (isKeyEnter(event)) {\n          submit.click();\n        }\n      });\n    });\n    const hideForm = $(this.formElement).find('*[name=hide-form]');\n    $(hideForm).on('click', () => {\n      $(this.formElement).addClass('hide');\n      const handleId = $(this.formElement).attr('data-item-id');\n      const handleItem = $(`#${handleId}`)[0];\n      $(handleItem).removeClass('hide');\n    });\n    const finishItemButtons = $(this.listElement).children('*[name=finish]');\n    finishItemButtons.forEach((button) => {\n      $(button).on('click', () => {\n        const item = $(button).parents('.mission-item')[0];\n        $(item).remove();\n      });\n    });\n    this.initDocument();\n    this.init = 1;\n    return this;\n  }\n\n  initDocument() {\n    if (document.supportMission) return false;\n    document.ondragover = (event) => {\n      event.preventDefault();\n    };\n    document.ondrop = (event) => {\n      const data = event.dataTransfer.getData('Text').match(/^item-\\d+$/);\n      const itemId = data && data[0];\n      if (isString(itemId)) {\n        const dragItem = $(`#${itemId}`)[0];\n        if (!dragItem) return false;\n        $(dragItem).removeClass('item-curtain').attr('draggable', 'false');\n      }\n      return true;\n    };\n    document.ondragend = () => {\n      const missionItems = this.listElement.querySelectorAll('.mission-item');\n      const dragId = $(this.listElement).attr('drag');\n      const id = Number(dragId.match(/^item-(\\d+)$/)[1]);\n      const dragItem = $(`#${dragId}`)[0];\n      let dragIndex;\n      missionItems.forEach((item, index) => {\n        if (dragItem.isSameNode(item)) dragIndex = index;\n        $(item).removeClass('item-curtain').attr('draggable', 'false');\n      });\n      const prevItem = missionItems[dragIndex - 1];\n      const nextItem = missionItems[dragIndex + 1];\n      const prevOrder = (isElement(prevItem)) ? Number($(prevItem).attr('order')) : 0;\n      const nextOrder = (isElement(nextItem)) ? Number($(nextItem).attr('order')) : (prevOrder + 2);\n      if (!Number.isFinite(prevOrder) || !Number.isFinite(nextOrder)) throw new ReferenceError('拖动的条目前后存在条目没有有效order属性');\n      const newOrder = (prevOrder + nextOrder) / 2;\n      missions.ready()\n        .then(() => missions.get(id))\n        .then((result) => {\n          const updateData = result;\n          updateData.order = newOrder;\n          return missions.set(updateData);\n        }).then(() => {\n          $(dragItem).attr('order', newOrder);\n          Message.alert('位置已改变');\n        });\n      $(this.listElement).attr('drag', '');\n    };\n    $(document).on('click', (event) => {\n      const isFormHide = $(this.formElement).hasClass('hide');\n      if (isFormHide) return false;\n      const paths = event.path;\n      const hideFormButton = $(this.formElement).find('*[name=hide-form]');\n      let isInMission = false;\n      paths.forEach((element) => {\n        if (!isElement(element)) return;\n        if (this.element.isSameNode(element)) isInMission = true;\n      });\n      if (!isInMission) hideFormButton.click();\n      return isInMission;\n    });\n    document.supportMission = 1;\n    return this;\n  }\n\n  static isElementComplete() {\n    const element = document.querySelector('#mission');\n    const listElement = document.querySelector('#mission-list');\n    const formElement = document.querySelector('#mission-form');\n    const adderElement = document.querySelector('#add-mission');\n    return element && listElement && formElement && adderElement;\n  }\n\n  static transformItem(missionItem) {\n    if (!isElement(missionItem) || !missionItem.classList.contains('mission-item')) throw new TypeError('不是任务列表的子元素');\n    const parent = $(missionItem).parent();\n    const nextItem = missionItem.nextSibling;\n    const form = $('#mission-form')[0];\n    const content = $(missionItem).find('*[name=content]').innerText;\n    const date = $(missionItem).find('*[name=date]').innerText;\n    const missionItems = parent.querySelectorAll('.mission-item');\n    const submit = $(form).find('*[name=submit]');\n    missionItems.forEach((item) => {\n      if (item.id !== missionItem.id) {\n        $(item).removeClass('hide');\n      }\n    });\n    $(missionItem).addClass('hide');\n    parent.insertBefore(form, nextItem);\n    $(form).removeClass('hide').attr('data-item-id', missionItem.id);\n    $(form).find('input[name=content]').value = content;\n    $(form).find('input[name=date]').value = date;\n    $(submit).text('保存');\n    return form;\n  }\n\n  static createMissionItem(leftText, rightText, id) {\n    if (!Mission.isElementComplete()) throw new ReferenceError('界面元素不完整');\n    const item = $('<li>').addClass('mission-item').attr('id', `item-${id}`);\n    const before = $('<div>').addClass('item-before');\n    const moveIcon = $('<i>').addClass('fa fa-arrows');\n    const left = $('<div>').addClass('item-left');\n    const right = $('<div>').addClass('item-right');\n    const icon = $('<i>').addClass('fa fa-circle-o item-icon fa-lg').attr('name', 'finish');\n    const text = $('<span>').attr('name', 'content').text(leftText);\n    const date = $('<span>').attr('name', 'date').addClass('text-sm-center').text(rightText);\n    const link = $('<a>').append(icon);\n    window.link = link;\n    moveIcon.on('mousedown', () => {\n      item.attr('draggable', 'true');\n    });\n    text.on('click', () => {\n      Mission.transformItem(item.dom);\n    });\n    link.on('click', () => {\n      missions.ready()\n        .then(() => missions.delete(id))\n        .then(() => item.remove());\n    });\n    item.on('dragstart', (event) => {\n      const parent = item.parent();\n      $(parent).attr('drag', item.dom.id);\n      event.dataTransfer.setData('Text', item.dom.id);\n      item.addClass('item-curtain');\n    });\n    item.on('dragover', (event) => {\n      event.preventDefault();\n      const parent = item.parent();\n      const itemNext = item.dom.nextSibling;\n      const dragId = $(parent).attr('drag');\n      const dragItem = $(parent).find(`#${dragId}`);\n      const index = { itemIndex: 0, dragIndex: 0 };\n      const childNodes = parent.children;\n      childNodes.forEach = Array.prototype.forEach;\n      childNodes.forEach((node, i) => {\n        if (item.dom.isSameNode(node)) index.itemIndex = i;\n        if (dragItem.isSameNode(node)) index.dragIndex = i;\n      });\n      const positionItem = (index.dragIndex > index.itemIndex) ? item.dom : itemNext;\n      parent.insertBefore(dragItem, positionItem);\n    });\n    item.on('drop', (event) => {\n      event.preventDefault();\n      const parent = item.parent();\n      const itemNext = item.dom.nextSibling;\n      const dragId = event.dataTransfer.getData('Text');\n      const dragItem = $(parent).find(`#${dragId}`);\n      const dragNext = dragItem.nextSibling;\n      parent.insertBefore(item.dom, dragNext);\n      parent.insertBefore(dragItem, itemNext);\n      $(dragItem).removeClass('item-curtain').attr('draggable', 'false');\n    });\n    before.append(moveIcon);\n    left.append(link).append(text);\n    right.append(date);\n    item.append(before).append(left).append(right);\n    return item.dom;\n  }\n\n  createMission() {\n    const form = this.formElement;\n    const contentInput = $(form).find('input[name=content]');\n    if (!contentInput.value) return false;\n    const dateInput = $(form).find('input[type=date]');\n    this.counter += 1;\n    const item = { content: contentInput.value, date: dateInput.value, order: this.counter };\n    missions.ready()\n      .then(() => missions.create(item))\n      .then((id) => {\n        const missionItem = Mission.createMissionItem(contentInput.value, dateInput.value, id);\n        contentInput.value = '';\n        dateInput.value = '';\n        $(this.listElement).append(missionItem);\n      });\n    $(this.formElement).attr('data-item-id', '');\n    return this;\n  }\n\n  updateMission() {\n    const itemId = $(this.formElement).attr('data-item-id');\n    if (!itemId) return false;\n    const item = $(`#${itemId}`)[0];\n    if (!item) throw new ReferenceError(`找不到#${itemId}元素`);\n    const contentInput = $(this.formElement).find('input[name=content]');\n    const dateInput = $(this.formElement).find('input[name=date]');\n    const content = contentInput.value;\n    const date = dateInput.value;\n    const id = Number(itemId.match(/^item-(\\d+)$/)[1]);\n    const data = { id, content, date };\n    missions.ready()\n      .then(() => missions.save(data))\n      .then(() => {\n        $(item).find('*[name=content]').innerText = content;\n        $(item).find('*[name=date]').innerText = date;\n        $(item).removeClass('hide');\n        contentInput.value = '';\n        dateInput.value = '';\n        $(this.formElement).addClass('hide');\n      });\n    return this;\n  }\n\n  static hideForm() {\n    const form = document.querySelector('#mission-form');\n    if (!isElement(form)) throw new ReferenceError('没有找到mission-form');\n    const hideFormButton = $(form).find('*[name=hide-form]');\n    if (!isElement(form)) throw new ReferenceError('没有找到mission-form表单取消按钮');\n    return hideFormButton.click();\n  }\n\n  static getElement() {\n    return document.querySelector('#mission');\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const mission = new Mission();\n  window.mission = mission;\n  mission.createMission();\n  window.show = () => (\n    missions.ready()\n      .then(() => missions.getAll())\n      .then(result => console.log(result))\n  );\n});\n"]}