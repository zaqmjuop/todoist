parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"fRxd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(e){return"string"==typeof e},n=function(e){return!(!e||!r(e))},o=function(e){if(!n(e))throw new TypeError("参数classes不能为 "+e);return e.replace(/\s+/g," ").split(" ")},i=0,a=function(){function r(e){if(t(this,r),!e)throw new TypeError("new Dom参数不能为"+e);if(e instanceof r)this.dom=e.dom;else if(e instanceof HTMLElement)this.dom=e;else if(n(e)){var o=e.match(/^<(.+)>$/);this.dom=o?document.createElement(o[1]):document.querySelector(e)}return this}return e(r,[{key:"attr",value:function(e,t){if(!n(e))throw new TypeError("参数key不能为 "+e);var r=this;return arguments.length>1&&(e.toLocaleLowerCase().match(/^text$/)?this.dom.innerText=String(t):e.toLocaleLowerCase().match(/^html$/)?this.dom.innerHTML=String(t):"INPUT"===this.dom.tagName&&"value"===e?this.dom.value=String(t):this.dom.setAttribute(e,t)),arguments.length<=1&&(r=e.toLocaleLowerCase().match(/^text$/)?this.dom.innerText:e.toLocaleLowerCase().match(/^html$/)?this.dom.innerHTML:"INPUT"===this.dom.tagName&&"value"===e?this.dom.value:this.dom.getAttribute(e)),r}},{key:"addClass",value:function(e){var t=this;return o(e).forEach(function(e){t.dom.classList.contains(e)||t.dom.classList.add(e)}),this}},{key:"removeClass",value:function(e){var t=this;return o(e).forEach(function(e){t.dom.classList.contains(e)&&t.dom.classList.remove(e)}),this}},{key:"hasClass",value:function(e){var t=this,r=o(e),n=!0;return r.forEach(function(e){t.dom.classList.contains(e)||(n=!1)}),n}},{key:"toggleClass",value:function(e){return this.hasClass(e)?this.removeClass(e):this.addClass(e),this}},{key:"append",value:function(e){var t=this;return(n(e)?document.querySelectorAll(e):[r.degenerate(e)]).forEach(function(e){t.dom.appendChild(e)}),this}},{key:"appendAccurate",value:function(e,t){if(!Number.isSafeInteger(t))throw new TypeError(t+"不是整数");var n=r.of(e);if(t<0||t>this.dom.childElementCount||0===this.dom.childElementCount)this.dom.appendChild(n.dom);else{var o=this.dom.children[t];n.insertBefore(o)}return this}},{key:"replace",value:function(e){if(!r.isElement(e))throw new TypeError(e+"不是HTMLElement");var t=this.dom.parentElement;return t&&t.replaceChild(e,this.dom),e}},{key:"insertBefore",value:function(e){if(!r.isElement(e))throw new TypeError(e+"不是HTMLElement");var t=e.parentElement;return t&&t.insertBefore(this.dom,e),e}},{key:"insertAfter",value:function(e){if(!r.isElement(e))throw new TypeError(e+"不是HTMLElement");var t=e.parentElement;if(t){var n=e.nextElementSibling;n?t.insertBefore(this.dom,n):t.appendChild(this.dom)}return e}},{key:"selfDestruct",value:function(){if(!this.dom)return!1;var e=this.dom.parentElement;return!!e&&(e.removeChild(this.dom),this)}},{key:"remove",value:function(e){var t=this;return 0===arguments.length?this.selfDestruct():((n(e)?this.dom.querySelectorAll(e):[r.degenerate(e)]).forEach(function(e){t.dom.removeChild(e)}),this)}},{key:"text",value:function(e){var t=void 0;return void 0!==e?(this.dom.innerText=String(e),t=this):t=this.dom.innerText,t}},{key:"html",value:function(e){var t=void 0;return void 0!==e?(this.dom.innerHTML=String(e),t=this):t=this.dom.innerHTML,t}},{key:"child",value:function(e){return n(e)?this.dom.querySelector(e):r.degenerate(e)}},{key:"children",value:function(e){var t=void 0;if(void 0===e)t=this.dom.children();else{if(!n(e))throw new TypeError("selector不能为"+e);t=this.dom.querySelectorAll(e)}return t}},{key:"parent",value:function(e){return r.getParent(this.dom,e)}},{key:"parents",value:function(e){return r.getParents(this.dom,e)}},{key:"hasParent",value:function(e){return r.hasParent(this.dom,e)}},{key:"on",value:function(e,t){if(!n(e))throw new TypeError("event不能是"+e);if("function"!=typeof t)throw new TypeError("callback不能是"+t);return this.dom.addEventListener(e,t),this}},{key:"off",value:function(e,t){if(!n(e))throw new TypeError("event不能是"+e);if("function"!=typeof t)throw new TypeError("callback不能是"+t);return this.dom.removeEventListener(e,t),this}},{key:"clear",value:function(e){if(!n(e))throw new TypeError("event不能是"+e);return this.dom["on"+e]=void 0,this}},{key:"hasChild",value:function(e){return r.hasChild(this.dom,e)}},{key:"getIndex",value:function(){var e=this.dom.parentElement;return e?Array.from(e.children).indexOf(this.dom):-1}}],[{key:"all",value:function(e){return document.querySelectorAll(e)}},{key:"of",value:function(e){return new r(e)}},{key:"degenerate",value:function(e){var t=void 0;if(e instanceof r)t=e.dom;else if(e instanceof HTMLElement)t=e;else{if(!n(e))throw new TypeError("参数query不能是"+e);t=document.querySelector(e)}return t}},{key:"isElement",value:function(e){return e&&e instanceof HTMLElement&&1===e.nodeType}},{key:"getParentsTree",value:function(e){if(!r.isElement(e))throw new TypeError("element不能是"+e);for(var t=[],n=e;n.parentElement;)n=n.parentElement,t.push(n);return t}},{key:"getParent",value:function(e,t){if(!r.isElement(e))throw new TypeError("element不能是"+e);var o=void 0,i=r.getParentsTree(e),a=document.querySelectorAll(t);if(void 0===t)o=e.parentElement;else{var l=void 0;if(n(t))l=i;else if(t instanceof r)l=[t.dom];else{if(!(t instanceof HTMLElement))throw new TypeError("query不能是"+t);l=[t]}l.forEach(function(e){a.forEach(function(t){t.isSameNode(e)&&(o=e)})})}return o}},{key:"hasChild",value:function(e,t){if(!r.isElement(e))throw new TypeError("element不能是"+e);var o=void 0,i=function t(n){if(!r.isElement(n))return!1;var o=n.parentElement;return!!e.isSameNode(o)||t(o)};if(n(t))o=!!e.querySelector(t);else if(t instanceof HTMLElement)o=i(t);else{if(!(t instanceof r))throw new TypeError("query不能是"+t);o=i(t.dom)}return o}},{key:"getParents",value:function(e,t){if(!r.isElement(e))throw new TypeError("element不能是"+e);var o=void 0,i=r.getParentsTree(e),a=document.querySelectorAll(t);if(void 0===t)o=i;else{if(o=[],!n(t))throw new TypeError("query不能是"+t);i.forEach(function(e){a.forEach(function(t){t.isSameNode(e)&&o.push(e)})})}return o}},{key:"hasParent",value:function(e,t){if(!r.isElement(e))throw new TypeError("element不能是"+e);if(arguments.length<2)throw new Error("缺少参数");var n=!1,o=r.getParentsTree(e);if(o.length<1)return!1;var i=r.isElement(t)?t:r.of(String(t));return o.find(function(e){return e.isSameNode(i)})&&(n=!0),n}},{key:"globalInit",value:function(){return!i&&(i+=1,HTMLCollection.prototype.forEach=Array.prototype.forEach,i)}}]),r}();a.globalInit(),exports.default=a;
},{}],"FO+Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(n){return n instanceof KeyboardEvent&&13===n.keyCode},e=function(n){return n&&1===n.nodeType},r=function(n){return n&&"string"==typeof n},t=function(n){return n&&"function"==typeof n},i=new Date,o=function(n){var e=n&&n instanceof Date?n:new Date(String(n));return e.getTime()?e.toLocaleDateString().replace(/\//g,"-"):""},a=function(n){if(!(n instanceof Date))throw new TypeError("formatTime 参数date不能是"+n);return n.toTimeString().match(/^\S+/)[0]},f=function(n){return n&&n instanceof Date&&n.getTime()},u=function(){return new Promise(function(n){return n(1)})},c=function(n,e){if(!(n instanceof Date&&e instanceof Date))throw new TypeError("differDay的参数不能是 "+n+" 和 "+e);var r=n;return(e.getTime()-r.getTime())/864e5},s=function(n){var e=null==n||!1===n||n===[]||n==={},r=!String(n).match(/\S/);return e||r},y=function(n,e){if(!(n instanceof Array))throw new TypeError("divisio "+n+" 不是Array");if(!(e instanceof Function))throw new TypeError("divisio "+e+" 不是Function");var r=[[],[]];return n.forEach(function(n){e(n)?r[0].push(n):r[1].push(n)}),r},p=function(n,e){if(!(n instanceof Array))throw new TypeError("flat "+n+" 不是Array");if(e&&(!Number.isSafeInteger(e)||e<1))throw new TypeError("flat "+e+" 不是Integer或deep < 1");for(var r=n,t=e||1,i=function(n){var e=[];return n.forEach(function(n){n instanceof Array?n.forEach(function(n){return e.push(n)}):e.push(n)}),e},o=0;o<t;o+=1)r=i(r);return r};exports.default={isElement:e,isKeyEnter:n,isString:r,isFunction:t,isEmptyString:s,newPromise:u,formatDate:o,formatTime:a,now:i,isValidDate:f,differDay:c,divisio:y,flat:p};
},{}],"PSwN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./utils"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}var n={get:function(e,t){if("string"!=typeof e)throw new TypeError("路径错误");if(!(t instanceof Function))throw new TypeError("回调函数错误");var r=window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");r.open("GET",e,!0),r.send(),r.onreadystatechange=function(e){return 4===r.readyState&&200===r.status&&t(e)}}},o={get:function(e){if(!t.default.isString(e))throw new TypeError("参数url是路径 字符串类型");return new Promise(function(t){n.get(e,function(e){t(e.target.response)})})}};exports.default=o;
},{"./utils":"FO+Z"}],"dB3M":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),n=require("../dom"),r=c(n),o=require("../utils"),a=c(o),i=require("../ajax"),u=c(i);function c(e){return e&&e.__esModule?e:{default:e}}function l(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=new Set,p=100001,m=function(){return p+=1},d=function(){function n(t){var o=this;if(f(this,n),"object"!==(void 0===t?"undefined":e(t)))throw new TypeError("param应该是一个object");if(!a.default.isElement(t.template))throw new TypeError("param.template应该是一个HtmlElement");var i=Object.assign(this,t);a.default.isString(this.query)&&r.default.of(this.template).attr("data-c-query",this.query);var u=r.default.of(i.query).dom||r.default.of("*[data-c-query="+i.query+"]").dom;if(!u)throw new TypeError("选择器 "+i.query+" 未找到匹配项");if(i.query=u,i.elements={},i.selectors&&"object"===e(i.selectors)){var c=Object.keys(i.selectors),p={};c.forEach(function(e){var t=i.selectors[e];if(t&&a.default.isString(t)){var n=i.template.querySelector(t);a.default.isElement(n)&&(r.default.of(n).attr("data-c-selector",e),p[e]=n)}}),Object.keys(p).length>0&&(p.template=i.template,i.elements=p)}var m=i.parent;Object.defineProperty(i,"parent",{enumerable:!0,configurable:!0,get:function(){return m},set:function(e){if(e===m)return m;if(null!=e&&!n.isComponent(e))throw new TypeError("父组件不可以为"+e);return n.isComponent(m)&&m.components.delete(i),e?(m=e).components.add(i):m=null,m}}),i.parent=m;var d=void 0;if(i.components){if(!(i.components instanceof Array||i.components instanceof Set))throw new TypeError(t.components+"不能作为子组件集");d=new Set([].concat(l(i.components)))}else d=new Set;if(i.components=d,i.present=i.present||{},!(i.data instanceof Function))throw new TypeError("缺少data属性或data不是Function类型");var y=i.data();if(i.data=Object.assign({},y),y instanceof Array||"object"!==(void 0===y?"undefined":e(y)))throw new TypeError("data应该返回一个Object");if(Object.keys(i.data).some(function(e){return i.data[e]instanceof Function}))throw new TypeError("data返回的Object中不能含有Function");if(i.watch instanceof Function){var h=i.watch();if(h instanceof Object&&!(h instanceof Array)){var v=Object.keys(h),w=Object.keys(y);v.filter(function(e){return w.includes(e)}).forEach(function(e){Object.defineProperty(i.data,e,{enumerable:!0,get:function(){return y[e]},set:function(t){y[e]=t,h[e]()}})})}}if(!i.name){var b=i.url.match(/([^\/]+)\.html/)[1];i.name=b}if(i.setComponentId(),i.methods){var E={};Object.keys(i.methods).forEach(function(e){var t=i.methods[e];"function"==typeof t&&(E[e]=t.bind(i))}),i.methods=E}return this.formatChildren().then(function(){return o.lifeCycle()}),s.add(i),i}return t(n,[{key:"formatChildren",value:function(){var e=this,t=new Promise(function(e){return e(1)});return Array.from(this.components).filter(function(e){return!(e instanceof n)}).forEach(function(o){var a=Object.assign({},o);if(a.passon instanceof Array){var i={};if(0===a.passon.length)i=e.present;else{var u=Object.keys(e.present);a.passon.filter(function(e){return"string"==typeof e&&u.includes(e)}).forEach(function(t){i[t]=e.present[t]})}a.present=i}t=t.then(function(){return n.pjaxFormatHtml(a.url)}).then(function(t){var i=t.template,u=t.style,c=e.template.querySelector(a.query);if(!r.default.isElement(c))throw new Error("子组件插入位置未找到"+o.query);a.query=c,a.template=i,a.style=u,a.parent=e;var l=n.of(a),f=r.default.of(c).attr("data-c-selector");return f&&(e.elements[f]=l.template),e.components.delete(o),e.components.add(l),l})}),t}},{key:"lifeCycle",value:function(){a.default.isFunction(this.created)&&this.created(),this.implant(),a.default.isFunction(this.implanted)&&this.implanted()}},{key:"refresh",value:function(e){e&&(this.present=e),a.default.isFunction(this.created)&&this.created(),a.default.isFunction(this.implanted)&&this.implanted()}},{key:"findBy",value:function(e){return n.findBy(e,this)}},{key:"where",value:function(e){return n.where(e,this)}},{key:"addEventListener",value:function(e,t){this.template.addEventListener(e,t)}},{key:"dispatchEvent",value:function(e,t){var n=new CustomEvent(e,{detail:t});this.template.dispatchEvent(n)}},{key:"setComponentId",value:function(){var e=this;this.componentId=String(m()),this.template.setAttribute("data-c-id","c"+this.componentId),this.style.setAttribute("data-c-id","c"+this.componentId);return function t(n){return n instanceof HTMLElement&&!(n.childElementCount<1)&&(n.children.forEach(function(n){n.setAttribute("data-c-id","c"+e.componentId),t(n)}),n)}(this.template),this}},{key:"replaceGeneralScopedStyles",value:function(e){var t=this,n=e.match(/[#\u002e\u002aA-Za-z][^{}]*{([^{}]*{[^{}]*})*[^{}]*}/g);return n.forEach(function(e,r){var o=t.replaceGeneralScopedStyle(e);n[r]=o}),n.join(" ")}},{key:"replaceGeneralScopedStyle",value:function(e){var t=this,n=e.replace(/\s*{.*$/,"").replace(/^\s*/,"").split(",");n.forEach(function(e,r){var o=e.replace(/[#\u002a\u002eA-Za-z][^\s+~>{]*/g,function(e){return e.replace(/([#\u002a\u002eA-Za-z][^:]*)/,function(e){return e+"[data-c-id=c"+t.componentId+"]"})});n[r]=o});var r=n.join(",");return e.replace(/^[^{}]*{/,function(){return r+" {"})}},{key:"handleScopedStyle",value:function(){var e=this;if(!(this.style.getAttribute("scoped")||""===this.style.getAttribute("scoped")))return!1;var t=this.style.innerHTML.replace(/\u002f\u002a(\u002f\u002a|[^\u002a])*\u002a\u002f/g,"").replace(/\n/g,"").replace(/\s+/g," ").match(/(@keyframes|@media|[#\u002e\u002aA-Za-z])[^{}]*{([^{}]*{[^{}]*})*[^{}]*}/g);if(!t)return!1;t.forEach(function(n,r){var o=void 0;if(n.match("@keyframes"))o=n;else if(n.match("@media")){var a=n.match(/^[^@]*@media[^{]*{/)[0],i=n.replace(a,"").replace(/}[^}]*$/,"");o=a+" "+e.replaceGeneralScopedStyles(i)+" }"}else o=e.replaceGeneralScopedStyle(n);t[r]=o});var n=t.join(" ");return this.style.innerHTML=n,this}},{key:"implant",value:function(){var e=this.style.getAttribute("scoped")||""===this.style.getAttribute("scoped");if(r.default.of(this.query).replace(this.template),this.style){e&&this.handleScopedStyle();var t=document.querySelector("style[data-c-id=c"+this.componentId+"]");t?document.querySelector("head").replaceChild(this.style,t):document.querySelector("head").appendChild(this.style)}return this}},{key:"appendChild",value:function(e,t,r){return n.appendComponent(e,this,t,r)}},{key:"replaceChild",value:function(e,t){var r=this;return n.replaceComponent(e,t).then(function(e){return e.parent=r,e})}},{key:"removeChild",value:function(e){if(!this.components.has(e))throw new TypeError("不是子组件"+JSON.stringify(e));return n.removeComponent(e)}},{key:"replace",value:function(e){return n.replaceComponent(e,this)}}],[{key:"findBy",value:function(e,t){var r=Object.keys(e),o=r.find(function(e){return"name"===e}),a=r.find(function(e){return"componentId"===e});if(!o&&!a)throw new Error("查询参数无效"+JSON.stringify(e));if(arguments.length>1&&!(t instanceof n))throw new TypeError("不是有效组件"+JSON.stringify(t));if(a&&!Number.isSafeInteger(e.componentId))throw new TypeError("不是有效组件componentId "+e.componentId);for(var i=null,u=arguments.length>1?t.components:s,c=Array.from(u),l=0;l<c.length;l+=1){var f=c[l],p=!o||e.name===f.name,m=!a||Number(e.componentId)===Number(f.componentId);if(p&&m){i=f;break}}return i}},{key:"where",value:function(e,t){if(!e.name&&!e.componentId)throw new Error("查询参数无效"+JSON.stringify(e));if(arguments.length>1&&!(t instanceof n))throw new TypeError("不是有效组件"+JSON.stringify(t));var r=arguments.length>1?t.components:s;return Array.from(r).filter(function(t){var n=!e.name||e.name===t.name,r=!e.componentId||e.componentId===t.componentId;return n&&r})}},{key:"pjaxFormatHtml",value:function(e){if(!e||"string"!=typeof e)throw new TypeError(e+"不是有效的html文件地址");return u.default.get(e).then(function(e){var t=document.createElement("html");t.innerHTML=e;var n=t.querySelectorAll("style"),r=t.querySelector("body");if(n.length>1)throw new TypeError("至多可以有一个<style>元素");if(1!==r.childElementCount)throw new TypeError("<body>内应有且只有一个根元素");return{template:r.firstElementChild,style:n[0]||document.createElement("style")}})}},{key:"of",value:function(e){return new n(e)}},{key:"pjaxCreate",value:function(e){if(!a.default.isString(e.url))throw new TypeError("param.url应该是字符串类型html文件地址");return n.pjaxFormatHtml(e.url).then(function(t){var r=Object.assign(e,t);return n.of(r)})}},{key:"all",value:function(){return s}},{key:"isComponent",value:function(e){return e&&e instanceof n}},{key:"appendComponent",value:function(e,t,o,a){if(!n.isComponent(t))throw new TypeError(t+"不是组件");if(!(r.default.isElement(o)&&(t.template.isSameNode(o)||r.default.of(o).hasParent(t.template))))throw new TypeError(o+"不是组件id:"+t.componentId+"的子元素");if(!Number.isSafeInteger(a))throw new TypeError("不是整数"+a);var i=new Promise(function(t){return t(e)});if(!(e instanceof n)){var u=Object.assign(e);i=n.pjaxFormatHtml(u.url).then(function(e){var t=e.template,r=e.style;return u.query=t,u.template=t,u.style=r,n.of(u)})}return i=i.then(function(e){r.default.of(o).appendAccurate(e.template,a);var n=r.default.of("head");return n.hasChild(e.style)||n.append(e.style),e.parent=t,e})}},{key:"replaceComponent",value:function(e,t){if(!n.isComponent(t))throw new TypeError(t+"不是组件实例化对象");var o=new Promise(function(t){return t(e)});if(!n.isComponent(e)){if(!a.default.isString(e.url))throw new TypeError("param.url应该是字符串类型html文件地址");o=n.pjaxFormatHtml(e.url).then(function(r){var o=r.template,a=r.style;return e.template=o,e.style=a,e.query=t.template,n.of(e)})}return o=o.then(function(e){return r.default.of(t.template).replace(e.template),r.default.of(t.style).replace(e.style),e.parent=t.parent,e})}},{key:"removeComponent",value:function(e){if(!n.isComponent(e))throw new TypeError(e+"不是一个组件");var t=function e(t){return!!n.isComponent(t)&&(r.default.of(t.style).remove(),s.delete(t),t.components.forEach(function(t){return e(t)}),t.components.clear(),t.parent=null,function e(t){return!!n.isComponent(t)&&!!r.default.of("*[data-c-id=c"+t.componentId+"]").remove()&&e(t)}(t),t.removed&&t.removed instanceof Function&&t.removed(),t)};return new Promise(function(n){t(e),r.default.of(e.template).remove(),n(e)})}}]),n}();d.components=s,window.Component=d,exports.default=d;
},{"../dom":"fRxd","../utils":"FO+Z","../ajax":"PSwN"}],"OU4j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../utils"),e=d(t),a=require("../dom"),i=d(a);function d(t){return t&&t.__esModule?t:{default:t}}var n={query:"left-menu",url:"./assets/templates/leftMenu.html",name:"leftMenu",data:function(){return{date:e.default.now}},passon:[],selectors:{date:".date",time:".time"},methods:{init:function(){return!this.data.inited&&(this.methods.fillTime(),this.data.inited=1,this)},fillTime:function(){var t=this;!function a(){var d=new Date,n=e.default.formatDate(d),u=e.default.formatTime(d);t.data.dateStr!==n&&(t.data.dateStr=n,i.default.of(t.elements.date).attr("text",n)),i.default.of(t.elements.time).attr("text",u),t.data.fillTimeOut=window.setTimeout(a,1e3)}()}},created:function(){this.methods.init()}};exports.default=n;
},{"../utils":"FO+Z","../dom":"fRxd"}],"lXUg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(e){return e&&1===e.nodeType},n=function(e){return e&&"string"==typeof e},o=function(e){return!!r(e)&&e.parentNode},i=function(e){if(!r(e))return!1;for(var t=[],n=e,i=0;i<999&&(n=o(n),r(n));i+=1)t.push(n);return t},u=function(){function o(e){if(t(this,o),"string"==typeof e){var n=e.match(/^<(.+)>$/);if(!n)return document.querySelectorAll(e);var i=n[1].toLocaleUpperCase();this.dom=document.createElement(i)}else if(e instanceof o)this.dom=e.dom;else{if(!r(e)&&e!==document)throw console.warn(e),new TypeError("无效参数");this.dom=e}return this}return e(o,[{key:"attr",value:function(e,t){if(!e||!n(e))throw new TypeError("没有key参数");var r=this;return void 0!==t?this.dom.setAttribute(e,""+t):r=this.dom.getAttribute(e),r}},{key:"addClass",value:function(e){var t=this;if(!e||"string"!=typeof e)throw new TypeError("参数应该是字符串");return e.split(" ").forEach(function(e){e&&t.dom.classList.add(e)}),this}},{key:"removeClass",value:function(e){var t=this;if(!e||"string"!=typeof e)throw new TypeError("参数应该是字符串");return e.split(" ").forEach(function(e){e&&t.dom.classList.remove(e)}),this}},{key:"hasClass",value:function(e){if(!e||"string"!=typeof e)throw new TypeError("参数应该是字符串");if(e.match(" "))throw new TypeError("参数不能含有空格");return this.dom.classList.contains(e)}},{key:"toggleClass",value:function(e){if(!e||"string"!=typeof e)throw new TypeError("参数应该是字符串");return this.hasClass(e)?this.removeClass(e):this.addClass(e),this}},{key:"append",value:function(e){var t=e instanceof o?e.dom:e;if(!t||1!==t.nodeType)throw new TypeError("参数不是html元素");return this.dom.appendChild(t),this}},{key:"remove",value:function(e){if(e){if(r(e))this.dom.removeChild(e);else if(n(e)){var t=this.dom.querySelector(e);this.dom.removeChild(t)}}else this.dom.remove();return this}},{key:"text",value:function(e){return this.dom.innerText=e,this}},{key:"html",value:function(e){return this.dom.innerHTML=e,this}},{key:"find",value:function(e){return this.dom.querySelector(e)}},{key:"children",value:function(e){return this.dom.querySelectorAll(e)}},{key:"parent",value:function(){var e=this.dom.parentNode;return e&&1===e.nodeType?e:void 0}},{key:"parents",value:function(e){var t=i(this.dom),r=[];e&&n(e)?document.querySelectorAll(e).forEach(function(e){t.includes(e)&&r.push(e)}):r=t;return r}},{key:"on",value:function(e,t){return this.dom.addEventListener(e,t),this}},{key:"off",value:function(e,t){return this.dom.removeEventListener(e,t),this}},{key:"hasParent",value:function(e){if(!o.isElement(e))return!1;var t=this.parents(),r=!1;return t.forEach(function(t){e.isSameNode(t)&&(r=!0)}),r}}],[{key:"of",value:function(e){return new o(e)}},{key:"isElement",value:function(e){return e&&1===e.nodeType}}]),o}();exports.default=u;
},{}],"KHEc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=[31,28,31,30,31,30,31,31,30,31,30,31],n=function(e){return Number.isInteger(e)&&e>1900&&e<5001},a=function(e){return Number.isInteger(e)&&e>=0&&e<12},o=function(){function o(e){if(t(this,o),!(e&&e instanceof Date))throw new TypeError("参数应是一个Date实例对象");return this.year=e.getFullYear(),this.month=e.getMonth(),this.day=e.getDate(),this}return e(o,[{key:"backOneMonth",value:function(){return this.month-=1,this.month<0&&(this.year-=1,this.month=11),this}},{key:"aheadOneMonth",value:function(){return this.month+=1,this.month>11&&(this.year+=1,this.month=0),this}},{key:"toDate",value:function(){return new Date(this.year,this.month,this.day)}},{key:"reset",value:function(e){var t=o.of(e);if(!t)throw new TypeError("哪里出现了问题");return this.year=t.year,this.month=t.month,this.day=t.day,this}}],[{key:"of",value:function(e){return new o(e)}},{key:"getMonths",value:function(e){if(!n(e))throw new TypeError("参数应该是一个数字，有效值1901-5000");var t=r;return e%4==0&&(t[1]=29),t}},{key:"getDaysCount",value:function(e,t){if(!n(e))throw new TypeError("参数应该是一个数字，有效值1901-5000");if(!a(t))throw new TypeError("参数应该是一个数字，有效值0-11");return o.getMonths(e)[t]}},{key:"getWeekArray",value:function(e){if(!(e instanceof Date))throw new TypeError("参数应该是一个Date实例对象");for(var t=[],r=o.getDaysCount(e.getFullYear(),e.getMonth()),n=new Date(e.getFullYear(),e.getMonth()-1,1),a=o.getDaysCount(n.getFullYear(),n.getMonth()),u=e.getDate()-e.getDay(),i=0;i<7;i+=1){var h=u+i;h>r?h-=r:h<1&&(h+=a),t.push(h)}return t}},{key:"getMonthArray",value:function(e){if(!(e&&e instanceof Date))throw new TypeError("参数应该是一个Date实例对象");var t=[],r=o.getDaysCount(e.getFullYear(),e.getMonth()),n=o.getWeekArray(e);t.push(n);for(var a=0;a<5;a+=1){var u=e.getDate()-e.getDay()-1-7*a;if(u>0){var i=new Date(e.getFullYear(),e.getMonth(),u),h=o.getWeekArray(i);t.unshift(h)}var s=e.getDate()-e.getDay()+7+7*a;if(s<=r){var y=new Date(e.getFullYear(),e.getMonth(),s),f=o.getWeekArray(y);t.push(f)}}return t}}]),o}();exports.default=o;
},{}],"On9m":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),t=require("./dom"),r=a(t),n=require("./customDate"),o=a(n);function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=0,d=0,f=function(e){if(!r.default.isElement(e))throw new TypeError("参数应是HTML Element");for(var t=0,n=e;r.default.isElement(n)&&"body"!==n.tagName&&"html"!==n.tagName;)t+=n.offsetTop,n=n.offsetParent;return t},l=function(e){if(!r.default.isElement(e))throw new TypeError("参数应是HTML Element");for(var t=0,n=e;r.default.isElement(n)&&"body"!==n.tagName&&"html"!==n.tagName;)t+=n.offsetLeft,n=n.offsetParent;return t},s=function(e,t){if(!r.default.isElement(e)||!r.default.isElement(t))throw new TypeError("参数应是HTML Element");var n=f(t),o=n-window.scrollY,a=window.scrollY+window.innerHeight-(n+t.offsetHeight)>e.offsetHeight,i=o>e.offsetHeight;return!a&&i?n-e.offsetHeight:n+t.offsetHeight},c=function(e,t){if(!r.default.isElement(e)||!r.default.isElement(t))throw new TypeError("参数应是HTML Element");var n=l(t);return document.body.offsetWidth-t.offsetWidth-n+t.offsetWidth>e.offsetWidth?n:n+t.offsetWidth-e.offsetWidth},h=function(){if(d)return!1;d+=1;var e=function(){var e=window.innerHeight;document.body.style.minHeight=e+"px"};return window.addEventListener("resize",function(){e()}),e(),d},y=function(){var e=r.default.of("<tr>"),t=r.default.of("<th>").text("◂").addClass("prev-month"),n=r.default.of("<th>"),o=r.default.of("<th>").text("▸").addClass("next-month"),a=r.default.of("<th>").attr("colspan",2).addClass("month"),i=r.default.of("<input>").attr("type","number").addClass("year");return[t,n,r.default.of("<th>").attr("colspan",2).append(i),a,o].forEach(function(t){e.append(t)}),e},p=function(){var e=r.default.of("<tr>").addClass("week-sign");return[r.default.of("<th>").text("日").addClass("text-red"),r.default.of("<th>").text("一"),r.default.of("<th>").text("二"),r.default.of("<th>").text("三"),r.default.of("<th>").text("四"),r.default.of("<th>").text("五"),r.default.of("<th>").text("六").addClass("text-red")].forEach(function(t){e.append(t)}),e},m=function(){for(var e=r.default.of("<tr>").addClass("week"),t=0;t<7;t+=1){var n=r.default.of("<td>");e.append(n)}return e},v=function(){for(var e=r.default.of("<div>").addClass("datepicker hide"),t=r.default.of("<table>").attr("border",1).attr("cellspacing",2),n=y(),o=p(),a=r.default.of("<thead>").append(n).append(o),i=r.default.of("<tbody>"),u=0;u<6;u+=1){var d=m();i.append(d)}return t.append(a).append(i),e.append(t),e.dom},b=function(){function t(e){if(i(this,t),!e||1!==e.nodeType||"text"!==e.getAttribute("type"))throw new TypeError("参数应是一个input[type=text]");var r=new Date;return this.input=e,this.body=v(),this.current=o.default.of(r),document.body.appendChild(this.body),this.fillDayPickerByDate(this.current.toDate()),this.bindEvent(),this}return e(t,[{key:"fillDayPickerByDate",value:function(e){var t=this;if(!(e&&e instanceof Date))throw new TypeError("参数应该是一个Date实例对象");this.current=o.default.of(e);var r=o.default.getMonthArray(this.current.toDate()),n=this.body.querySelector("tbody").querySelectorAll("tr");if(this.body.querySelector(".year").value=e.getFullYear(),this.body.querySelector(".month").innerText=e.getMonth()+1,5===r.length){var a=new Date(e.getFullYear(),e.getMonth()+1,6),i=o.default.getWeekArray(a);r.push(i)}return r.forEach(function(e,o){var a=n[o].querySelectorAll("td");e.forEach(function(e,n){var i=a[n];if(i.innerText=e,0===o?Number(e)>7?i.classList.add("prev-month"):i.classList.remove("prev-month"):o>=r.length-2&&(Number(e)<15?i.classList.add("next-month"):i.classList.remove("next-month")),t.current.day===e&&!i.classList.contains("prev-month")&&!i.classList.contains("next-month")){var u=t.body.querySelector(".current-picker");u&&u.classList.remove(".current-picker"),i.classList.add(".current-picker")}})}),this}},{key:"fillDayPickerByCurrent",value:function(){var e=this.current.toDate();return this.fillDayPickerByDate(e),this}},{key:"clearPicked",value:function(){return this.body.querySelectorAll(".current-picker").forEach(function(e){e.classList.remove(".current-picker")}),this}},{key:"bindMonthArrow",value:function(){var e=this,t=this.body.querySelector(".prev-month"),r=this.body.querySelector(".next-month");return t.addEventListener("click",function(){e.current.backOneMonth(),e.fillDayPickerByCurrent()}),r.addEventListener("click",function(){e.current.aheadOneMonth(),e.fillDayPickerByCurrent()}),this}},{key:"bindPickAction",value:function(){var e=this,t=this.body.querySelector("thead"),r=this.body.querySelector("tbody").querySelectorAll("td"),n=t.querySelector(".year"),o=t.querySelector(".month"),a=this.input;return r.forEach(function(t){t.addEventListener("click",function(){var r={year:Number(n.value),month:Number(o.innerText)-1,day:Number(t.innerText)};t.classList.contains("prev-month")?(r.month-=1,r.month<0&&(r.year-=1,r.month=11)):t.classList.contains("next-month")&&(r.month+=1,r.month>11&&(r.year+=1,r.month=0));var i=new Date(r.year,r.month,r.day);e.current.reset(i),e.clearPicked(),a.value=e.current.year+"-"+(e.current.month+1)+"-"+e.current.day,t.classList.add("current-picker"),e.body.classList.add("hide")})}),this}},{key:"bindTurnOn",value:function(){var e=this;return this.input.addEventListener("mousedown",function(t){t.stopPropagation(),r.default.of(e.body).removeClass("arrow-top arrow-bottom reel hide");var n=document.querySelectorAll(".datepicker"),o=f(e.input),a=l(e.input),i=s(e.body,e.input),u=c(e.body,e.input),d=i<o?"arrow-bottom":"arrow-top",h=u<a?"pseudo-right":"";n.forEach(function(t){e.body.isSameNode(t)||t.classList.add("hide")}),e.fillDayPickerByCurrent(),r.default.of(e.body).addClass("reel "+d+" "+h),e.body.style.top=i+"px",e.body.style.left=u+"px"}),this}},{key:"bindTurnOff",value:function(){return!u&&(u+=1,document.body.addEventListener("mousedown",function(e){var t=e.target;document.querySelectorAll(".datepicker").forEach(function(e){r.default.of(t).hasParent(e)||e.classList.add("hide")})}),this)}},{key:"bindYearInput",value:function(){var e=this,t=this.body.querySelector(".year"),r=this.body.querySelector(".month");t.addEventListener("input",function(){var n=Number(t.value);if(!Number.isSafeInteger(n)||n<1900||n>5e3)return!1;var o={year:n,month:Number(r.innerText)-1,day:1},a=new Date(o.year,o.month,o.day);return e.fillDayPickerByDate(a),e})}},{key:"bindEvent",value:function(){h(),this.bindMonthArrow(),this.bindPickAction(),this.bindTurnOn(),this.bindTurnOff(),this.bindYearInput()}}]),t}(),w=function(e){return new b(e)};window.datepicker=w,exports.default=w;
},{"./dom":"lXUg","./customDate":"KHEc"}],"7l9t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../dom"),e=o(t),i=require("../lib/datepicker"),a=o(i),n=require("./component"),s=o(n),d=require("../utils"),r=o(d);function o(t){return t&&t.__esModule?t:{default:t}}var h={query:"mission-form",url:"./assets/templates/missionForm.html",name:"missionForm",data:function(){return{inited:0}},selectors:{contentInput:"input[name=content]",dateInput:"input[name=date]",cancelForm:".cancel-form",submit:".submit"},methods:{formSubmit:function(){var t=e.default.of(this.elements.contentInput).attr("value");t||window.alert("请输入任务内容");var i=e.default.of(this.elements.dateInput).attr("value")||"",a=e.default.of(this.template).attr("data-item-id"),n=e.default.of(this.template).attr("data-cid"),s={content:t,date:i};return a?(s.id=Number(a),s.cid=n,this.dispatchEvent("update",s)):this.dispatchEvent("create",s),s},fill:function(){this.present=this.present||{},this.data.content=this.present.content||"",this.data.date=this.present.date||"",this.data.id=this.present.id||"",this.data.cid=this.present.cid||"",this.data.submitText=this.data.cid?"更新任务":"新建任务",e.default.of(this.elements.contentInput).attr("value",this.data.content),e.default.of(this.elements.dateInput).attr("value",this.methods.formatDate(this.data.date)),e.default.of(this.template).attr("data-item-id",this.data.id),e.default.of(this.template).attr("data-cid",this.data.cid),e.default.of(this.elements.submit).attr("text",this.data.submitText)},formatDate:function(t){var e=t&&t instanceof Date?t:new Date(String(t));return e.getTime()?e.toLocaleDateString().replace(/\//g,"-"):""},clear:function(){this.present={},this.methods.fill()},hide:function(){return this.methods.clear(),e.default.of(this.template).addClass("hide"),this.dispatchEvent("hide"),this},show:function(){return this.methods.fill(),e.default.of(this.template).removeClass("hide"),this.dispatchEvent("show"),this},init:function(){return!this.data.inited&&(this.data.picker=(0,a.default)(this.elements.dateInput),e.default.of(this.data.picker.body).attr("data-c-id","c"+this.componentId),this.methods.bindEvents(),this.data.inited=1,this)},reduce:function(){var t=this;if(!this.data.cid)return r.default.newPromise();var e=s.default.findBy({componentId:Number(this.data.cid)});if(!e)throw new ReferenceError("componentId:"+this.data.cid+"的Item未找到");return this.replace(e).then(function(){return t.present={},t.methods.hide(),t})},bindEvents:function(){var t=this;return!this.data.inited&&(e.default.of(this.elements.submit).on("click",function(e){e.stopPropagation(),t.methods.formSubmit()}),e.default.of(this.elements.cancelForm).on("click",function(e){return e.stopPropagation(),t.methods.reduce().then(function(){return t.methods.hide()})}),this)}},created:function(){this.methods.init(),this.methods.show()}};exports.default=h;
},{"../dom":"fRxd","../lib/datepicker":"On9m","./component":"dB3M","../utils":"FO+Z"}],"ceID":[function(require,module,exports) {
var define;
var e;parcelRequire=function(t,r,n,o){var a="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function c(e,n){if(!r[e]){if(!t[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!n&&o)return o(e,!0);if(a)return a(e,!0);if(i&&"string"==typeof e)return i(e);var u=new Error("Cannot find module '"+e+"'");throw u.code="MODULE_NOT_FOUND",u}f.resolve=function(r){return t[e][1][r]||r};var s=r[e]=new c.Module(e);t[e][0].call(s.exports,f,s,s.exports,this)}return r[e].exports;function f(e){return c(f.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=t,c.cache=r,c.parent=a,c.register=function(e,r){t[e]=[function(e,t){t.exports=r},{}]};for(var u=0;u<n.length;u++)c(n[u]);if(n.length){var s=c(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=s:"function"==typeof e&&e.amd&&e(function(){return s})}return c}({cdEW:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var a=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(!a)throw new ReferenceError("您的浏览器不支持indexeddb");var i=0,c=function(){return i+=1},u={databaseName:window.location.hostname,objectStoreName:"store"},s=function(e){if(!(e instanceof IDBRequest))throw new TypeError(e+"不是有效的IDBRequest");return new Promise(function(t,r){e.onsuccess=function(e){t(e.target.result)},e.onerror=function(e){r(e.target.error)}})},f=function(e,t){var r=void 0;if(e&&e instanceof Function||(r=t+" 参数callback不能是"+(void 0===e?"undefined":o(e))+"的"+e+",只接受Function类型callback"),r)throw new Error(r);return!0},h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r={};return r.id=c(),r.databaseName=t.databaseName||u.databaseName,r.objectStoreName=t.objectStoreName||u.objectStoreName,r.id>1&&(r.databaseName=""+r.databaseName+r.id),this.databaseName=r.databaseName,this.objectStoreName=r.objectStoreName,this.currentPromise=new Promise(function(e){return e(1)}),this}return n(e,[{key:"catchPromise",value:function(e,t){var r=this;if(!(e instanceof Promise))throw new TypeError(e+"不是Promise实例对象");if(t&&"string"!=typeof t)throw new TypeError("Error message: "+t+" 不是字符串");var n=e.catch(function(e){throw console.error(t,r,e),e});return this.currentPromise=n,n}},{key:"openDB",value:function(){var e=this,t=new Promise(function(t,r){var n=a.open(e.databaseName,e.version);n.onupgradeneeded=function(t){var r=t.target.result,n=e.objectStoreName;r.objectStoreNames.contains(n)||r.createObjectStore(n,{keyPath:"primaryKey",autoIncrement:!0})},n.onsuccess=function(r){var n=r.target.result;n.onclose=function(){n.state="closed"},n.onabort=function(){n.close()},n.onversionchange=function(){e.database=n,e.version=n.version},n.state="open",e.database=n,t(e.database)},n.onerror=function(e){r(e.target.error)}}),r=t.catch(function(r){return console.error(r),e.version=e.database.version,e.database.objectStoreNames.contains(e.objectStoreName)||(e.version+=1),t});return this.catchPromise(r,"Store.openDB")}},{key:"ready",value:function(){var e=this,t=this.database instanceof IDBDatabase&&"open"===this.database.state&&this.database.objectStoreNames.contains(this.objectStoreName)?this.currentPromise.then(function(){return e.database}):this.openDB();return this.catchPromise(t,"Store.ready")}},{key:"objectStore",value:function(){var e=this,t=this.ready().then(function(t){var r=e.objectStoreName;return t.transaction([r],"readwrite").objectStore(r)});return this.catchPromise(t,"Store.objectStore")}},{key:"clear",value:function(){var e=this.objectStore().then(function(e){var t=e.clear();return s(t)});return this.catchPromise(e,"Store.clear")}},{key:"getAll",value:function(){var e=this.objectStore().then(function(e){var t=e.getAll();return s(t)});return this.catchPromise(e,"Store.getAll")}},{key:"remove",value:function(e){var t=e instanceof Array?e:[e],r=void 0;t.forEach(function(e){if(Number.isSafeInteger(e)||(r="Store.remove primaryKey只接受Integer，不能是"+e),r)throw new Error(r)});var n=void 0,o=this.objectStore().then(function(e){n=e});return t.forEach(function(e){o=o.then(function(){var t=n.delete(e);return s(t)})}),o=o.then(function(){return t}),this.catchPromise(o,"Store.remove")}},{key:"get",value:function(e){var t=e instanceof Array?e:[e],r=[],n=void 0;t.forEach(function(e){if(Number.isSafeInteger(e)||(n="Store.get primaryKey只接受Integer，不能是"+e),n)throw new Error(n)});var o=void 0,a=this.objectStore().then(function(e){o=e});return t.forEach(function(e){a=a.then(function(){var t=o.get(e);return s(t)}).then(function(e){r.push(e)})}),a=a.then(function(){return r}),this.catchPromise(a,"Store.get")}},{key:"push",value:function(e){var t=void 0,r=e instanceof Array?e:[e],n=[];r.forEach(function(e){if(e instanceof Object||(t="Store.push item只接受对象，不能是"+e),e.primaryKey&&(t="Store.push data.primaryKey只接受null或undefiend，不能是"+e.primaryKey),t)throw new Error(t)});var o=void 0,a=this.objectStore().then(function(e){o=e});return r.forEach(function(e){a=a.then(function(){var t=o.add(e);return s(t)}).then(function(e){n.push(e)})}),a=a.then(function(){return n}),this.catchPromise(a,"Store.push")}},{key:"update",value:function(e){var t=void 0,r=e instanceof Array?e:[e],n=[];r.forEach(function(e){if(e instanceof Object||(t="Store.update data只接受对象，不能是"+e),e.primaryKey&&Number.isSafeInteger(e.primaryKey)||(t="Store.update data.primaryKey只接受Integer，不能是"+e.primaryKey),t)throw new Error(t)});var o=void 0,a=this.objectStore().then(function(e){o=e});return r.forEach(function(e){a=a.then(function(){var t=o.put(e);return s(t)}).then(function(e){n.push(e)})}),a=a.then(function(){return n}),this.catchPromise(a,"Store.update")}},{key:"formatOpenCursorWithSuccessCallback",value:function(e){var t="Store.formatOpenCursorWithSuccessCallback";f(e,t);var r=this.objectStore().then(function(t){var r=t.openCursor();return new Promise(function(t,n){r.onsuccess=function(r){var n=r.target.result,o=e(n);!o&&n||t(o)},r.onerror=function(e){n(e.target.error)}})});return this.catchPromise(r,t)}},{key:"find",value:function(e){f(e,"Store.find");var t=void 0,r=this.formatOpenCursorWithSuccessCallback(function(r){return r&&(e(r.value,r.primaryKey)?t=r.value:r.continue()),t});return this.catchPromise(r,"Store.find")}},{key:"filter",value:function(e){f(e,"Store.filter");var t=[],r=this.formatOpenCursorWithSuccessCallback(function(r){r&&(!!e(r.value,r.primaryKey)&&t.push(r.value),r.continue())}).then(function(){return t});return this.catchPromise(r,"Store.filter")}},{key:"map",value:function(e){f(e,"Store.map");var t=[],r=this.formatOpenCursorWithSuccessCallback(function(r){if(r){var n=e(r.value,r.primaryKey);t.push(n),r.continue()}}).then(function(){return t});return this.catchPromise(r,"Store.map")}}]),e}();window.ArrayStorage=h,r.default=h},{}]},{},["cdEW"]);
},{}],"JDu1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("arraystorage"),t=u(e),n=require("./utils"),r=u(n);function u(e){return e&&e.__esModule?e:{default:e}}var i=new t.default,o=function(){return i.getAll()},f=function(){return i.filter(function(e){return e.date instanceof Date&&r.default.differDay(e.date,r.default.now)>0})},a=function(){return i.filter(function(e){return"done"===e.state})},d=function(){return i.filter(function(e){return"done"!==e.state})},l={all:o,expired:f,done:a,undone:d},s=function(){return i.filter(function(e){return e.date instanceof Date&&r.default.differDay(e.date,r.default.now)>0})},c=function(e){return i.filter(function(t){return"string"==typeof t.mark&&t.mark===String(e)})},g=function(e){var t=void 0;return"string"==typeof e?t=l[e]?l[e]():c(e):e instanceof Date?t=s(e):console.warn("mission.methods.GetQuery 尚不支持查询"+e),t};i.methods={getAll:o,getExpired:f,getDate:s,getMark:c,getQuery:g},exports.default=i;
},{"arraystorage":"ceID","./utils":"FO+Z"}],"XGW9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../dom"),e=o(t),n=require("../model"),i=o(n),s=require("./component"),a=o(s),d=require("../utils"),r=o(d);function o(t){return t&&t.__esModule?t:{default:t}}var u={query:"mission-list-item",url:"./assets/templates/missionListItem.html",name:"missionListItem",selectors:{content:".item-content",date:".item-date",finish:".finish",itemMain:".item-main",counter:"#counter"},data:function(){return{counter:1,inited:0}},methods:{init:function(){return!this.data.inited&&(this.data.inited=1,this.methods.bindEvents(),this)},bindEvents:function(){var t=this;e.default.of(this.elements.finish).on("click",function(){var n="done"===t.present.state?"undone":"done",s={content:t.present.content,date:r.default.isValidDate(t.present.date)?t.present.date:"",primaryKey:Number(t.present.primaryKey),state:n};i.default.update(s).then(function(){e.default.of(t.template).toggleClass("done")})}),e.default.of(this.elements.content).on("click",function(){if(!t.data.formId)throw new Error("Item.data.formId不能为"+t.data.formId);var e=r.default.newPromise(),n=a.default.findBy({componentId:Number(t.data.formId)}),i={cid:t.componentId,content:t.data.content,date:t.data.date,id:t.data.id,formId:t.data.formId};return n.present=i,e=e.then(function(){return n.methods.reduce()}).then(function(){return t.replace(n)}).then(function(){n.present=i,n.methods.show()})})},fill:function(){this.present=this.present||{},this.data.content=this.present.content,this.data.date=this.present.date,this.data.id=this.present.id,this.data.formId=this.present.formId;var t=r.default.formatDate(this.present.date);e.default.of(this.elements.content).attr("text",this.present.content),e.default.of(this.elements.date).attr("text",t),e.default.of(this.template).attr("data-item-id",this.present.id),"done"===this.present.state&&e.default.of(this.template).addClass("done")}},created:function(){this.methods.init(),this.methods.fill()}};exports.default=u;
},{"../dom":"fRxd","../model":"JDu1","./component":"dB3M","../utils":"FO+Z"}],"5qA9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./missionForm"),t=c(e),n=require("./component"),r=c(n),i=require("../dom"),a=c(i),d=require("../model"),s=c(d),o=require("./missionListItem"),u=c(o),m=require("../utils"),f=c(m);function c(e){return e&&e.__esModule?e:{default:e}}var h=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],l={query:"mission-card",url:"./assets/templates/missionCard.html",name:"missionCard",data:function(){return{items:[],dayMark:"",dateMark:""}},passon:[],selectors:{form:"mission-form",cardHeader:".card-header",showForm:".show-form",createMission:".create-mission",cardBody:".card-body"},components:[t.default],methods:{init:function(){var e=this;if(this.data.inited)return!1;this.data.date=this.present.date,this.data.days=this.present.days;var t=f.default.newPromise().then(function(){return e.methods.initForm()}).then(function(){return e.methods.loadDB()}).then(function(){return e.methods.initItems()});return this.data.inited=1,t},initItems:function(){var e=this,t=f.default.newPromise();return this.data.items.forEach(function(n){t=t.then(function(){return e.methods.appendItem(n)})}),t},loadDB:function(){var e=this;return s.default.methods.getQuery(this.present.query).then(function(t){var n=f.default.divisio(t,function(e){return"done"!==e.state}).map(function(e){return f.default.divisio(e,function(e){return f.default.isValidDate(e.date)})}).map(function(e){return[e[0].sort(function(e,t){return e.date<=t.date}),e[1]]}),r=f.default.flat(n,2);return e.data.items=r,e.data.items})},appendItem:function(e){var t=Object.assign(e);t.formId=this.data.formId;var n=Object.assign({present:t},u.default),r=a.default.of(this.elements.form).getIndex();return this.appendChild(n,this.elements.cardBody,r)},initForm:function(){var e=this,n=this.findBy({name:t.default.name});return!!n&&(this.data.form=n,this.data.formId=n.componentId,n.addEventListener("hide",function(){a.default.of(e.elements.createMission).removeClass("hide")}),n.addEventListener("show",function(){a.default.of(e.elements.createMission).addClass("hide")}),n.methods.hide(),a.default.of(this.elements.showForm).on("click",function(){return n.methods.reduce().then(function(){var t=a.default.of(e.elements.createMission).getIndex();return e.appendChild(n,e.elements.cardBody,t)}).then(function(){n.present={date:e.data.date},n.methods.show()})}),n.addEventListener("create",function(t){if(!t.detail.content)return!1;var r={content:t.detail.content,date:new Date(t.detail.date)};return s.default.push(r).then(function(t){return r.primaryKey=t,e.methods.appendItem(r)}).then(function(){return n.methods.hide()})}),n.addEventListener("update",function(t){if(!t.detail.content)return!1;var i={content:t.detail.content,date:t.detail.date,primaryKey:t.detail.primaryKey},a=Object.assign({cid:e.componentId,formId:e.data.formId},i);return s.default.update(i).then(function(n){var i=r.default.findBy({componentId:Number(t.detail.cid)});a.primaryKey=n,i.present=a,i.methods.fill(),e.replaceChild(i,e.data.form)}).then(function(){return n.methods.hide()}),a}),n)}},created:function(){this.methods.init()}};exports.default=l;
},{"./missionForm":"7l9t","./component":"dB3M","../dom":"fRxd","../model":"JDu1","./missionListItem":"XGW9","../utils":"FO+Z"}],"4my8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./leftMenu"),t=u(e),i=require("./missionCard"),r=u(i),n=require("../dom"),s=u(n);function u(e){return e&&e.__esModule?e:{default:e}}var l={all:"所有任务",expired:"已过期",done:"已完成",undone:"未完成"},o={query:"mission-content",url:"./assets/templates/welcome.html",name:"welcome",present:{text:l},selectors:{title:".title",left:".left"},data:function(){return{}},methods:{init:function(){return!this.data.inited&&(this.data.inited=1,this)}},created:function(){var e=l[this.present.query]||String(this.present.query);s.default.of(this.elements.title).attr("text",e),this.methods.init()},components:[t.default,r.default]};exports.default=o;
},{"./leftMenu":"OU4j","./missionCard":"5qA9","../dom":"fRxd"}],"HYhh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./welcome"),e=n(t),r=require("./component"),a=n(r);function n(t){return t&&t.__esModule?t:{default:t}}var i={query:"router",url:"./assets/templates/router.html",name:"router",data:function(){return{counter:1,current:this,inited:0,path:"",state:{},origin:window.location.origin,href:window.location.href}},route:{welcome:e.default},methods:{init:function(){return!this.data.inited&&(this.data.inited=1,this)},render:function(t,e){var r=this,n=this.route[String(t)];if(!n)throw new Error("路径"+t+"对应Component不存在");this.data.path=t,this.data.state=Object.assign({},e);var i=Object.assign({},n),o=Object.assign({},i.present,this.data.state);i.present=o;var s=this.data.current;return s.replace(i).then(function(e){s!==r&&a.default.removeComponent(s),r.data.current=e;var n=r.data.origin+"/#/"+t+"/";return window.history.pushState(r.data.state,0,n),r.data.href=window.location.href,e})},restore:function(){return!!this.data.path&&this.methods.render(this.data.path,this.data.state)}},created:function(){this.methods.init(),window.router=this,this.methods.render("welcome",{query:"all"})}};exports.default=i;
},{"./welcome":"4my8","./component":"dB3M"}],"aDHB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./component"),t=r(e),n=require("./router"),o=r(n),i=require("../dom"),d=r(i);function r(e){return e&&e.__esModule?e:{default:e}}window.Dom=d.default;var u=function(){document.addEventListener("DOMContentLoaded",function(){window.addEventListener("resize",function(){document.body.style.offsetHeight=window.innerHeight+"px"}),window.resizeTo(window.innerWidth,window.innerHeight),t.default.pjaxCreate(o.default)})};exports.default=u;
},{"./component":"dB3M","./router":"HYhh","../dom":"fRxd"}],"Focm":[function(require,module,exports) {
"use strict";var e=require("./components/main"),n=t(e);function t(e){return e&&e.__esModule?e:{default:e}}window.now=new Date,(0,n.default)();
},{"./components/main":"aDHB"}]},{},["Focm"], null)
//# sourceMappingURL=/index.map