parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"fRxd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(e){return"string"==typeof e},n=function(e){return!(!e||!r(e))},o=function(e){if(!n(e))throw new TypeError("参数classes不能为 "+e);return e.replace(/\s+/g," ").replace(/^\s/,"").replace(/\s$/,"").split(" ")},i=0,a=function(){function r(e){if(t(this,r),!e)throw new TypeError("new Dom参数不能为"+e);if(e instanceof r)this.dom=e.dom;else if(e instanceof HTMLElement)this.dom=e;else if(n(e)){var o=e.match(/^<(.+)>$/);this.dom=o?document.createElement(o[1]):document.querySelector(e)}return this}return e(r,[{key:"attr",value:function(e,t){if(!n(e))throw new TypeError("参数key不能为 "+e);var r=this;return arguments.length>1&&(e.toLocaleLowerCase().match(/^text$/)?this.dom.innerText=String(t):e.toLocaleLowerCase().match(/^html$/)?this.dom.innerHTML=String(t):"INPUT"===this.dom.tagName&&"value"===e?this.dom.value=String(t):this.dom.setAttribute(e,t)),arguments.length<=1&&(r=e.toLocaleLowerCase().match(/^text$/)?this.dom.innerText:e.toLocaleLowerCase().match(/^html$/)?this.dom.innerHTML:"INPUT"===this.dom.tagName&&"value"===e?this.dom.value:this.dom.getAttribute(e)),r}},{key:"addClass",value:function(e){var t=this;return o(e).forEach(function(e){t.dom.classList.contains(e)||t.dom.classList.add(e)}),this}},{key:"removeClass",value:function(e){var t=this;return o(e).forEach(function(e){t.dom.classList.contains(e)&&t.dom.classList.remove(e)}),this}},{key:"hasClass",value:function(e){var t=this,r=o(e),n=!0;return r.forEach(function(e){t.dom.classList.contains(e)||(n=!1)}),n}},{key:"toggleClass",value:function(e){return this.hasClass(e)?this.removeClass(e):this.addClass(e),this}},{key:"append",value:function(e){var t=this;return(n(e)?document.querySelectorAll(e):[r.degenerate(e)]).forEach(function(e){t.dom.appendChild(e)}),this}},{key:"appendAccurate",value:function(e,t){if(!Number.isSafeInteger(t))throw new TypeError(t+"不是整数");var n=r.of(e);if(t<0||t>this.dom.childElementCount||0===this.dom.childElementCount)this.dom.appendChild(n.dom);else{var o=this.dom.children[t];n.insertBefore(o)}return this}},{key:"replace",value:function(e){if(!r.isElement(e))throw new TypeError(e+"不是HTMLElement");var t=this.dom.parentElement;return t&&t.replaceChild(e,this.dom),e}},{key:"insertBefore",value:function(e){if(!r.isElement(e))throw new TypeError(e+"不是HTMLElement");var t=e.parentElement;return t&&t.insertBefore(this.dom,e),e}},{key:"insertAfter",value:function(e){if(!r.isElement(e))throw new TypeError(e+"不是HTMLElement");var t=e.parentElement;if(t){var n=e.nextElementSibling;n?t.insertBefore(this.dom,n):t.appendChild(this.dom)}return e}},{key:"selfDestruct",value:function(){if(!this.dom)return!1;var e=this.dom.parentElement;return!!e&&(e.removeChild(this.dom),this)}},{key:"remove",value:function(e){var t=this;return 0===arguments.length?this.selfDestruct():((n(e)?this.dom.querySelectorAll(e):[r.degenerate(e)]).forEach(function(e){t.dom.removeChild(e)}),this)}},{key:"text",value:function(e){var t=void 0;return void 0!==e?(this.dom.innerText=String(e),t=this):t=this.dom.innerText,t}},{key:"html",value:function(e){var t=void 0;return void 0!==e?(this.dom.innerHTML=String(e),t=this):t=this.dom.innerHTML,t}},{key:"child",value:function(e){return n(e)?this.dom.querySelector(e):r.degenerate(e)}},{key:"children",value:function(e){var t=void 0;if(void 0===e)t=this.dom.children();else{if(!n(e))throw new TypeError("selector不能为"+e);t=this.dom.querySelectorAll(e)}return t}},{key:"parent",value:function(e){return r.getParent(this.dom,e)}},{key:"parents",value:function(e){return r.getParents(this.dom,e)}},{key:"hasParent",value:function(e){return r.hasParent(this.dom,e)}},{key:"on",value:function(e,t){if(!n(e))throw new TypeError("event不能是"+e);if("function"!=typeof t)throw new TypeError("callback不能是"+t);return this.dom.addEventListener(e,t),this}},{key:"off",value:function(e,t){if(!n(e))throw new TypeError("event不能是"+e);if("function"!=typeof t)throw new TypeError("callback不能是"+t);return this.dom.removeEventListener(e,t),this}},{key:"clear",value:function(e){if(!n(e))throw new TypeError("event不能是"+e);return this.dom["on"+e]=void 0,this}},{key:"hasChild",value:function(e){return r.hasChild(this.dom,e)}},{key:"getIndex",value:function(){var e=this.dom.parentElement;return e?Array.from(e.children).indexOf(this.dom):-1}},{key:"css",value:function(e,t){if(arguments.length>0&&"string"!=typeof e)throw new TypeError("Dom.css property 不能是"+e);if(arguments.length>1&&"string"!=typeof t)throw new TypeError("Dom.css value 不能是"+t);var r=void 0;return 0===arguments.length?r=window.getComputedStyle(this.dom):1===arguments.length?r=window.getComputedStyle(this.dom)[e]:(this.dom.style[e]=t,r=this),r}}],[{key:"all",value:function(e){return document.querySelectorAll(e)}},{key:"of",value:function(e){return new r(e)}},{key:"degenerate",value:function(e){var t=void 0;if(e instanceof r)t=e.dom;else if(e instanceof HTMLElement)t=e;else{if(!n(e))throw new TypeError("参数query不能是"+e);t=document.querySelector(e)}return t}},{key:"isElement",value:function(e){return e&&e instanceof HTMLElement&&1===e.nodeType}},{key:"getParentsTree",value:function(e){if(!r.isElement(e))throw new TypeError("element不能是"+e);for(var t=[],n=e;n.parentElement;)n=n.parentElement,t.push(n);return t}},{key:"getParent",value:function(e,t){if(!r.isElement(e))throw new TypeError("element不能是"+e);var o=void 0,i=r.getParentsTree(e),a=document.querySelectorAll(t);if(void 0===t)o=e.parentElement;else{var s=void 0;if(n(t))s=i;else if(t instanceof r)s=[t.dom];else{if(!(t instanceof HTMLElement))throw new TypeError("query不能是"+t);s=[t]}s.forEach(function(e){a.forEach(function(t){t.isSameNode(e)&&(o=e)})})}return o}},{key:"hasChild",value:function(e,t){if(!r.isElement(e))throw new TypeError("element不能是"+e);var o=void 0,i=function t(n){if(!r.isElement(n))return!1;var o=n.parentElement;return!!e.isSameNode(o)||t(o)};if(n(t))o=!!e.querySelector(t);else if(t instanceof HTMLElement)o=i(t);else{if(!(t instanceof r))throw new TypeError("query不能是"+t);o=i(t.dom)}return o}},{key:"getParents",value:function(e,t){if(!r.isElement(e))throw new TypeError("element不能是"+e);var o=void 0,i=r.getParentsTree(e),a=document.querySelectorAll(t);if(void 0===t)o=i;else{if(o=[],!n(t))throw new TypeError("query不能是"+t);i.forEach(function(e){a.forEach(function(t){t.isSameNode(e)&&o.push(e)})})}return o}},{key:"hasParent",value:function(e,t){if(!r.isElement(e))throw new TypeError("element不能是"+e);if(arguments.length<2)throw new Error("缺少参数");var n=!1,o=r.getParentsTree(e);if(o.length<1)return!1;var i=r.isElement(t)?t:r.of(String(t));return o.find(function(e){return e.isSameNode(i)})&&(n=!0),n}},{key:"globalInit",value:function(){return!i&&(i+=1,HTMLCollection.prototype.forEach=Array.prototype.forEach,i)}}]),r}();a.globalInit(),exports.default=a;
},{}],"FO+Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(n){return n instanceof KeyboardEvent&&13===n.keyCode},e=function(n){return n&&1===n.nodeType},r=function(n){return n&&"string"==typeof n},t=function(n){return n&&"function"==typeof n},i=new Date,o=function(n){var e=n&&n instanceof Date?n:new Date(String(n));return e.getTime()?e.toLocaleDateString().replace(/\//g,"-"):""},a=function(n){if(!(n instanceof Date))throw new TypeError("formatTime 参数date不能是"+n);return n.toTimeString().match(/^\S+/)[0]},f=function(n){return n&&n instanceof Date&&n.getTime()},u=function(){return new Promise(function(n){return n(1)})},c=function(n,e){if(!(n instanceof Date&&e instanceof Date))throw new TypeError("differDay的参数不能是 "+n+" 和 "+e);var r=n;return(e.getTime()-r.getTime())/864e5},s=function(n){var e=null==n||!1===n||n===[]||n==={},r=!String(n).match(/\S/);return e||r},y=function(n,e){if(!(n instanceof Array))throw new TypeError("divisio "+n+" 不是Array");if(!(e instanceof Function))throw new TypeError("divisio "+e+" 不是Function");var r=[[],[]];return n.forEach(function(n){e(n)?r[0].push(n):r[1].push(n)}),r},p=function(n,e){if(!(n instanceof Array))throw new TypeError("flat "+n+" 不是Array");if(e&&(!Number.isSafeInteger(e)||e<1))throw new TypeError("flat "+e+" 不是Integer或deep < 1");for(var r=n,t=e||1,i=function(n){var e=[];return n.forEach(function(n){n instanceof Array?n.forEach(function(n){return e.push(n)}):e.push(n)}),e},o=0;o<t;o+=1)r=i(r);return r};exports.default={isElement:e,isKeyEnter:n,isString:r,isFunction:t,isEmptyString:s,newPromise:u,formatDate:o,formatTime:a,now:i,isValidDate:f,differDay:c,divisio:y,flat:p};
},{}],"PSwN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./utils"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}var n={get:function(e,t){if("string"!=typeof e)throw new TypeError("路径错误");if(!(t instanceof Function))throw new TypeError("回调函数错误");var r=window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");r.open("GET",e,!0),r.send(),r.onreadystatechange=function(e){return 4===r.readyState&&200===r.status&&t(e)}}},o={get:function(e){if(!t.default.isString(e))throw new TypeError("参数url是路径 字符串类型");return new Promise(function(t){n.get(e,function(e){t(e.target.response)})})}};exports.default=o;
},{"./utils":"FO+Z"}],"dB3M":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),n=require("../dom"),r=c(n),o=require("../utils"),a=c(o),i=require("../ajax"),u=c(i);function c(e){return e&&e.__esModule?e:{default:e}}function l(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=window.location.href.match(/^[^#]+/)[0],p=new Set,m=100001,d=function(){return m+=1},h=function(){function n(t){var o=this;if(f(this,n),new.target!==n)throw new Error("必须使用 new 命令生成实例");if("object"!==(void 0===t?"undefined":e(t)))throw new TypeError("param应该是一个object");if(!a.default.isElement(t.template))throw new TypeError("param.template应该是一个HtmlElement");var i=Object.assign(this,t);a.default.isString(this.query)&&r.default.of(this.template).attr("data-c-query",this.query);var u=r.default.of(i.query).dom||r.default.of("*[data-c-query="+i.query+"]").dom;if(!u)throw new TypeError("选择器 "+i.query+" 未找到匹配项");if(i.query=u,i.elements={},i.selectors&&"object"===e(i.selectors)){var c=Object.keys(i.selectors),s={};c.forEach(function(e){var t=i.selectors[e];if(t&&a.default.isString(t)){var n=i.template.querySelector(t);a.default.isElement(n)&&(r.default.of(n).attr("data-c-selector",e),s[e]=n)}}),Object.keys(s).length>0&&(s.template=i.template,i.elements=s)}var m=i.parent;Object.defineProperty(i,"parent",{enumerable:!0,configurable:!0,get:function(){return m},set:function(e){if(e===m)return m;if(null!=e&&!n.isComponent(e))throw new TypeError("父组件不可以为"+e);return n.isComponent(m)&&m.components.delete(i),e?(m=e).components.add(i):m=null,m}}),i.parent=m;var d=void 0;if(i.components){if(!(i.components instanceof Array||i.components instanceof Set))throw new TypeError(t.components+"不能作为子组件集");d=new Set([].concat(l(i.components)))}else d=new Set;if(i.components=d,i.present=i.present||{},!(i.data instanceof Function))throw new TypeError("缺少data属性或data不是Function类型");var h=i.data();if(i.data=Object.assign({},h),h instanceof Array||"object"!==(void 0===h?"undefined":e(h)))throw new TypeError("data应该返回一个Object");if(Object.keys(i.data).some(function(e){return i.data[e]instanceof Function}))throw new TypeError("data返回的Object中不能含有Function");if(i.watch instanceof Function){var y=i.watch();if(y instanceof Object&&!(y instanceof Array)){var v=Object.keys(y),w=Object.keys(h);v.filter(function(e){return w.includes(e)}).forEach(function(e){Object.defineProperty(i.data,e,{enumerable:!0,get:function(){return h[e]},set:function(t){h[e]=t,y[e]()}})})}}if(!i.name){var b=i.url.match(/([^\/]+)\.html/)[1];i.name=b}if(i.setComponentId(),i.methods){var E={};Object.keys(i.methods).forEach(function(e){var t=i.methods[e];"function"==typeof t&&(E[e]=t.bind(i))}),i.methods=E}return this.formatChildren().then(function(){return o.lifeCycle()}),p.add(i),i}return t(n,[{key:"formatChildren",value:function(){var e=this,t=new Promise(function(e){return e(1)});return Array.from(this.components).filter(function(e){return!(e instanceof n)}).forEach(function(o){var a=Object.assign({},o);if(a.passon instanceof Array){var i={};if(0===a.passon.length)i=e.present;else{var u=Object.keys(e.present);a.passon.filter(function(e){return"string"==typeof e&&u.includes(e)}).forEach(function(t){i[t]=e.present[t]})}a.present=i}t=t.then(function(){return n.pjaxFormatHtml(a.url)}).then(function(t){var i=t.template,u=t.style,c=e.template.querySelector(a.query);if(!r.default.isElement(c))throw new Error("子组件插入位置未找到"+o.query);a.query=c,a.template=i,a.style=u,a.parent=e;var l=n.of(a),f=r.default.of(c).attr("data-c-selector");return f&&(e.elements[f]=l.template),e.components.delete(o),e.components.add(l),l})}),t}},{key:"lifeCycle",value:function(){a.default.isFunction(this.created)&&this.created(),this.implant(),a.default.isFunction(this.implanted)&&this.implanted()}},{key:"refresh",value:function(e){e&&(this.present=e),a.default.isFunction(this.created)&&this.created(),a.default.isFunction(this.implanted)&&this.implanted()}},{key:"findBy",value:function(e){return n.findBy(e,this)}},{key:"where",value:function(e){return n.where(e,this)}},{key:"addEventListener",value:function(e,t){this.template.addEventListener(e,t)}},{key:"dispatchEvent",value:function(e,t){var n=new CustomEvent(e,{detail:t});this.template.dispatchEvent(n)}},{key:"setComponentId",value:function(){var e=this;this.componentId=String(d()),this.template.setAttribute("data-c-id","c"+this.componentId),this.style.setAttribute("data-c-id","c"+this.componentId);return function t(n){return n instanceof HTMLElement&&!(n.childElementCount<1)&&(n.children.forEach(function(n){n.setAttribute("data-c-id","c"+e.componentId),t(n)}),n)}(this.template),this}},{key:"replaceGeneralScopedStyles",value:function(e){var t=this,n=e.match(/[#\u002e\u002aA-Za-z][^{}]*{([^{}]*{[^{}]*})*[^{}]*}/g);return n.forEach(function(e,r){var o=t.replaceGeneralScopedStyle(e);n[r]=o}),n.join(" ")}},{key:"replaceGeneralScopedStyle",value:function(e){var t=this,n=e.replace(/\s*{.*$/,"").replace(/^\s*/,"").split(",");n.forEach(function(e,r){var o=e.replace(/[#\u002a\u002eA-Za-z][^\s+~>{]*/g,function(e){return e.replace(/([#\u002a\u002eA-Za-z][^:]*)/,function(e){return e+"[data-c-id=c"+t.componentId+"]"})});n[r]=o});var r=n.join(",");return e.replace(/^[^{}]*{/,function(){return r+" {"})}},{key:"handleScopedStyle",value:function(){var e=this;if(!(this.style.getAttribute("scoped")||""===this.style.getAttribute("scoped")))return!1;var t=this.style.innerHTML.replace(/\u002f\u002a(\u002f\u002a|[^\u002a])*\u002a\u002f/g,"").replace(/\n/g,"").replace(/\s+/g," ").match(/(@keyframes|@media|[#\u002e\u002aA-Za-z])[^{}]*{([^{}]*{[^{}]*})*[^{}]*}/g);if(!t)return!1;t.forEach(function(n,r){var o=void 0;if(n.match("@keyframes"))o=n;else if(n.match("@media")){var a=n.match(/^[^@]*@media[^{]*{/)[0],i=n.replace(a,"").replace(/}[^}]*$/,"");o=a+" "+e.replaceGeneralScopedStyles(i)+" }"}else o=e.replaceGeneralScopedStyle(n);t[r]=o});var n=t.join(" ");return this.style.innerHTML=n,this}},{key:"implant",value:function(){var e=this.style.getAttribute("scoped")||""===this.style.getAttribute("scoped");if(r.default.of(this.query).replace(this.template),this.style){e&&this.handleScopedStyle();var t=document.querySelector("style[data-c-id=c"+this.componentId+"]");t?document.querySelector("head").replaceChild(this.style,t):document.querySelector("head").appendChild(this.style)}return this}},{key:"appendChild",value:function(e,t,r){return n.appendComponent(e,this,t,r)}},{key:"replaceChild",value:function(e,t){var r=this;return n.replaceComponent(e,t).then(function(e){return e.parent=r,e})}},{key:"removeChild",value:function(e){if(!this.components.has(e))throw new TypeError("不是子组件"+JSON.stringify(e));return n.removeComponent(e)}},{key:"replace",value:function(e){return n.replaceComponent(e,this)}}],[{key:"findBy",value:function(e,t){var r=Object.keys(e),o=r.find(function(e){return"name"===e}),a=r.find(function(e){return"componentId"===e});if(!o&&!a)throw new Error("查询参数无效"+JSON.stringify(e));if(arguments.length>1&&!(t instanceof n))throw new TypeError("不是有效组件"+JSON.stringify(t));if(a&&!Number.isSafeInteger(e.componentId))throw new TypeError("不是有效组件componentId "+e.componentId);for(var i=null,u=arguments.length>1?t.components:p,c=Array.from(u),l=0;l<c.length;l+=1){var f=c[l],s=!o||e.name===f.name,m=!a||Number(e.componentId)===Number(f.componentId);if(s&&m){i=f;break}}return i}},{key:"where",value:function(e,t){if(!e.name&&!e.componentId)throw new Error("查询参数无效"+JSON.stringify(e));if(arguments.length>1&&!(t instanceof n))throw new TypeError("不是有效组件"+JSON.stringify(t));var r=arguments.length>1?t.components:p;return Array.from(r).filter(function(t){var n=!e.name||e.name===t.name,r=!e.componentId||e.componentId===t.componentId;return n&&r})}},{key:"pjaxFormatHtml",value:function(e){if(!e||"string"!=typeof e)throw new TypeError(e+"不是有效的html文件地址");if(e.match(/^\u002e\u002f/)){var t=e.replace(/^\u002e/,"");s.match(/\u002f$/)&&(t=t.replace(/^\u002f/,""));s.concat(t)}return u.default.get(e).then(function(e){var t=document.createElement("html");t.innerHTML=e;var n=t.querySelectorAll("style"),r=t.querySelector("body");if(n.length>1)throw new TypeError("至多可以有一个<style>元素");if(1!==r.childElementCount)throw new TypeError("<body>内应有且只有一个根元素");return{template:r.firstElementChild,style:n[0]||document.createElement("style")}})}},{key:"of",value:function(e){return new n(e)}},{key:"pjaxCreate",value:function(e){if(!a.default.isString(e.url))throw new TypeError("param.url应该是字符串类型html文件地址");return n.pjaxFormatHtml(e.url).then(function(t){var r=Object.assign(e,t);return n.of(r)})}},{key:"all",value:function(){return p}},{key:"isComponent",value:function(e){return e&&e instanceof n}},{key:"appendComponent",value:function(e,t,o,a){if(!n.isComponent(t))throw new TypeError(t+"不是组件");if(!(r.default.isElement(o)&&(t.template.isSameNode(o)||r.default.of(o).hasParent(t.template))))throw new TypeError(o+"不是组件id:"+t.componentId+"的子元素");if(!Number.isSafeInteger(a))throw new TypeError("不是整数"+a);var i=new Promise(function(t){return t(e)});if(!(e instanceof n)){var u=Object.assign(e);i=n.pjaxFormatHtml(u.url).then(function(e){var t=e.template,r=e.style;return u.query=t,u.template=t,u.style=r,n.of(u)})}return i=i.then(function(e){r.default.of(o).appendAccurate(e.template,a);var n=r.default.of("head");return n.hasChild(e.style)||n.append(e.style),e.parent=t,e})}},{key:"replaceComponent",value:function(e,t){if(!n.isComponent(t))throw new TypeError(t+"不是组件实例化对象");var o=new Promise(function(t){return t(e)});if(!n.isComponent(e)){if(!a.default.isString(e.url))throw new TypeError("param.url应该是字符串类型html文件地址");o=n.pjaxFormatHtml(e.url).then(function(r){var o=r.template,a=r.style;return e.template=o,e.style=a,e.query=t.template,n.of(e)})}return o=o.then(function(e){return r.default.of(t.template).replace(e.template),r.default.of(t.style).replace(e.style),e.parent=t.parent,e})}},{key:"removeComponent",value:function(e){if(!n.isComponent(e))throw new TypeError(e+"不是一个组件");var t=function e(t){return!!n.isComponent(t)&&(r.default.of(t.style).remove(),p.delete(t),t.components.forEach(function(t){return e(t)}),t.components.clear(),t.parent=null,function e(t){return!!n.isComponent(t)&&!!r.default.of("*[data-c-id=c"+t.componentId+"]").remove()&&e(t)}(t),t.removed&&t.removed instanceof Function&&t.removed(),t)};return new Promise(function(n){t(e),r.default.of(e.template).remove(),n(e)})}}]),n}();h.components=p,window.Component=h,exports.default=h;
},{"../dom":"fRxd","../utils":"FO+Z","../ajax":"PSwN"}],"OU4j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../utils"),e=d(t),a=require("../dom"),i=d(a);function d(t){return t&&t.__esModule?t:{default:t}}var n={query:"left-menu",url:"./assets/templates/leftMenu.html",name:"leftMenu",data:function(){return{date:e.default.now}},passon:[],selectors:{date:".date",time:".time"},methods:{init:function(){return!this.data.inited&&(this.methods.fillTime(),this.data.inited=1,this)},fillTime:function(){var t=this;!function a(){var d=new Date,n=e.default.formatDate(d),u=e.default.formatTime(d);t.data.dateStr!==n&&(t.data.dateStr=n,i.default.of(t.elements.date).attr("text",n)),i.default.of(t.elements.time).attr("text",u),t.data.fillTimeOut=window.setTimeout(a,1e3)}()}},created:function(){this.methods.init()}};exports.default=n;
},{"../utils":"FO+Z","../dom":"fRxd"}],"On9m":[function(require,module,exports) {
var define;
var e,t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};parcelRequire=function(r,n,o,i){var a="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function s(e,t){if(!n[e]){if(!r[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!t&&o)return o(e,!0);if(a)return a(e,!0);if(u&&"string"==typeof e)return u(e);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}f.resolve=function(t){return r[e][1][t]||t};var l=n[e]=new s.Module(e);r[e][0].call(l.exports,f,l,l.exports,this)}return n[e].exports;function f(e){return s(f.resolve(e))}}s.isParcelRequire=!0,s.Module=function(e){this.id=e,this.bundle=s,this.exports={}},s.modules=r,s.cache=n,s.parent=a,s.register=function(e,t){r[e]=[function(e,r){r.exports=t},{}]};for(var l=0;l<o.length;l++)s(o[l]);if(o.length){var f=s(o[o.length-1]);"object"==("undefined"==typeof exports?"undefined":t(exports))&&"undefined"!=typeof module?module.exports=f:"function"==typeof e&&e.amd&&e(function(){return f})}return s}({fRxd:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(e){return!(!e||!function(e){return"string"==typeof e}(e))},i=function(e){if(!o(e))throw new TypeError("参数classes不能为 "+e);return e.replace(/\s+/g," ").replace(/^\s/,"").replace(/\s$/,"").split(" ")},a=0,u=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new TypeError("new Dom参数不能为"+t);if(t instanceof e)this.dom=t.dom;else if(t instanceof HTMLElement)this.dom=t;else if(o(t)){var r=t.match(/^<(.+)>$/);this.dom=r?document.createElement(r[1]):document.querySelector(t)}return this}return n(e,[{key:"attr",value:function(e,t){if(!o(e))throw new TypeError("参数key不能为 "+e);var r=this;return arguments.length>1&&(e.toLocaleLowerCase().match(/^text$/)?this.dom.innerText=String(t):e.toLocaleLowerCase().match(/^html$/)?this.dom.innerHTML=String(t):"INPUT"===this.dom.tagName&&"value"===e?this.dom.value=String(t):this.dom.setAttribute(e,t)),arguments.length<=1&&(r=e.toLocaleLowerCase().match(/^text$/)?this.dom.innerText:e.toLocaleLowerCase().match(/^html$/)?this.dom.innerHTML:"INPUT"===this.dom.tagName&&"value"===e?this.dom.value:this.dom.getAttribute(e)),r}},{key:"addClass",value:function(e){var t=this;return i(e).forEach(function(e){t.dom.classList.contains(e)||t.dom.classList.add(e)}),this}},{key:"removeClass",value:function(e){var t=this;return i(e).forEach(function(e){t.dom.classList.contains(e)&&t.dom.classList.remove(e)}),this}},{key:"hasClass",value:function(e){var t=this,r=i(e),n=!0;return r.forEach(function(e){t.dom.classList.contains(e)||(n=!1)}),n}},{key:"toggleClass",value:function(e){return this.hasClass(e)?this.removeClass(e):this.addClass(e),this}},{key:"append",value:function(t){var r=this;return(o(t)?document.querySelectorAll(t):[e.degenerate(t)]).forEach(function(e){r.dom.appendChild(e)}),this}},{key:"appendAccurate",value:function(t,r){if(!Number.isSafeInteger(r))throw new TypeError(r+"不是整数");var n=e.of(t);if(r<0||r>this.dom.childElementCount||0===this.dom.childElementCount)this.dom.appendChild(n.dom);else{var o=this.dom.children[r];n.insertBefore(o)}return this}},{key:"replace",value:function(t){if(!e.isElement(t))throw new TypeError(t+"不是HTMLElement");var r=this.dom.parentElement;return r&&r.replaceChild(t,this.dom),t}},{key:"insertBefore",value:function(t){if(!e.isElement(t))throw new TypeError(t+"不是HTMLElement");var r=t.parentElement;return r&&r.insertBefore(this.dom,t),t}},{key:"insertAfter",value:function(t){if(!e.isElement(t))throw new TypeError(t+"不是HTMLElement");var r=t.parentElement;if(r){var n=t.nextElementSibling;n?r.insertBefore(this.dom,n):r.appendChild(this.dom)}return t}},{key:"selfDestruct",value:function(){if(!this.dom)return!1;var e=this.dom.parentElement;return!!e&&(e.removeChild(this.dom),this)}},{key:"remove",value:function(t){var r=this;return 0===arguments.length?this.selfDestruct():((o(t)?this.dom.querySelectorAll(t):[e.degenerate(t)]).forEach(function(e){r.dom.removeChild(e)}),this)}},{key:"text",value:function(e){var t=void 0;return void 0!==e?(this.dom.innerText=String(e),t=this):t=this.dom.innerText,t}},{key:"html",value:function(e){var t=void 0;return void 0!==e?(this.dom.innerHTML=String(e),t=this):t=this.dom.innerHTML,t}},{key:"child",value:function(t){return o(t)?this.dom.querySelector(t):e.degenerate(t)}},{key:"children",value:function(e){var t=void 0;if(void 0===e)t=this.dom.children();else{if(!o(e))throw new TypeError("selector不能为"+e);t=this.dom.querySelectorAll(e)}return t}},{key:"parent",value:function(t){return e.getParent(this.dom,t)}},{key:"parents",value:function(t){return e.getParents(this.dom,t)}},{key:"hasParent",value:function(t){return e.hasParent(this.dom,t)}},{key:"on",value:function(e,t){if(!o(e))throw new TypeError("event不能是"+e);if("function"!=typeof t)throw new TypeError("callback不能是"+t);return this.dom.addEventListener(e,t),this}},{key:"off",value:function(e,t){if(!o(e))throw new TypeError("event不能是"+e);if("function"!=typeof t)throw new TypeError("callback不能是"+t);return this.dom.removeEventListener(e,t),this}},{key:"clear",value:function(e){if(!o(e))throw new TypeError("event不能是"+e);return this.dom["on"+e]=void 0,this}},{key:"hasChild",value:function(t){return e.hasChild(this.dom,t)}},{key:"getIndex",value:function(){var e=this.dom.parentElement;return e?Array.from(e.children).indexOf(this.dom):-1}},{key:"css",value:function(e,t){if(arguments.length>0&&"string"!=typeof e)throw new TypeError("Dom.css property 不能是"+e);if(arguments.length>1&&"string"!=typeof t)throw new TypeError("Dom.css value 不能是"+t);var r=void 0;return 0===arguments.length?r=window.getComputedStyle(this.dom):1===arguments.length?r=window.getComputedStyle(this.dom)[e]:(this.dom.style[e]=t,r=this),r}}],[{key:"all",value:function(e){return document.querySelectorAll(e)}},{key:"of",value:function(t){return new e(t)}},{key:"degenerate",value:function(t){var r=void 0;if(t instanceof e)r=t.dom;else if(t instanceof HTMLElement)r=t;else{if(!o(t))throw new TypeError("参数query不能是"+t);r=document.querySelector(t)}return r}},{key:"isElement",value:function(e){return e&&e instanceof HTMLElement&&1===e.nodeType}},{key:"getParentsTree",value:function(t){if(!e.isElement(t))throw new TypeError("element不能是"+t);for(var r=[],n=t;n.parentElement;)n=n.parentElement,r.push(n);return r}},{key:"getParent",value:function(t,r){if(!e.isElement(t))throw new TypeError("element不能是"+t);var n=void 0,i=e.getParentsTree(t),a=document.querySelectorAll(r);if(void 0===r)n=t.parentElement;else{var u=void 0;if(o(r))u=i;else if(r instanceof e)u=[r.dom];else{if(!(r instanceof HTMLElement))throw new TypeError("query不能是"+r);u=[r]}u.forEach(function(e){a.forEach(function(t){t.isSameNode(e)&&(n=e)})})}return n}},{key:"hasChild",value:function(t,r){if(!e.isElement(t))throw new TypeError("element不能是"+t);var n=void 0,i=function r(n){if(!e.isElement(n))return!1;var o=n.parentElement;return!!t.isSameNode(o)||r(o)};if(o(r))n=!!t.querySelector(r);else if(r instanceof HTMLElement)n=i(r);else{if(!(r instanceof e))throw new TypeError("query不能是"+r);n=i(r.dom)}return n}},{key:"getParents",value:function(t,r){if(!e.isElement(t))throw new TypeError("element不能是"+t);var n=void 0,i=e.getParentsTree(t),a=document.querySelectorAll(r);if(void 0===r)n=i;else{if(n=[],!o(r))throw new TypeError("query不能是"+r);i.forEach(function(e){a.forEach(function(t){t.isSameNode(e)&&n.push(e)})})}return n}},{key:"hasParent",value:function(t,r){if(!e.isElement(t))throw new TypeError("element不能是"+t);if(arguments.length<2)throw new Error("缺少参数");var n=!1,o=e.getParentsTree(t);if(o.length<1)return!1;var i=e.isElement(r)?r:e.of(String(r));return o.find(function(e){return e.isSameNode(i)})&&(n=!0),n}},{key:"globalInit",value:function(){return!a&&(a+=1,HTMLCollection.prototype.forEach=Array.prototype.forEach,a)}}]),e}();u.globalInit(),r.default=u},{}],UXHO:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=[31,28,31,30,31,30,31,31,30,31,30,31],i=function(e){return Number.isInteger(e)&&e>1900&&e<5001},a=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t&&t instanceof Date))throw new TypeError("参数应是一个Date实例对象");return this.year=t.getFullYear(),this.month=t.getMonth(),this.day=t.getDate(),this}return n(e,[{key:"backOneMonth",value:function(){return this.month-=1,this.month<0&&(this.year-=1,this.month=11),this}},{key:"aheadOneMonth",value:function(){return this.month+=1,this.month>11&&(this.year+=1,this.month=0),this}},{key:"toDate",value:function(){return new Date(this.year,this.month,this.day)}},{key:"reset",value:function(t){var r=e.of(t);if(!r)throw new TypeError("哪里出现了问题");return this.year=r.year,this.month=r.month,this.day=r.day,this}}],[{key:"of",value:function(t){return new e(t)}},{key:"getMonths",value:function(e){if(!i(e))throw new TypeError("参数应该是一个数字，有效值1901-5000");var t=o;return e%4==0&&(t[1]=29),t}},{key:"getDaysCount",value:function(t,r){if(!i(t))throw new TypeError("参数应该是一个数字，有效值1901-5000");if(!function(e){return Number.isInteger(e)&&e>=0&&e<12}(r))throw new TypeError("参数应该是一个数字，有效值0-11");return e.getMonths(t)[r]}},{key:"getWeekArray",value:function(t){if(!(t instanceof Date))throw new TypeError("参数应该是一个Date实例对象");for(var r=[],n=e.getDaysCount(t.getFullYear(),t.getMonth()),o=new Date(t.getFullYear(),t.getMonth()-1,1),i=e.getDaysCount(o.getFullYear(),o.getMonth()),a=t.getDate()-t.getDay(),u=0;u<7;u+=1){var s=a+u;s>n?s-=n:s<1&&(s+=i),r.push(s)}return r}},{key:"getMonthArray",value:function(t){if(!(t&&t instanceof Date))throw new TypeError("参数应该是一个Date实例对象");var r=[],n=e.getDaysCount(t.getFullYear(),t.getMonth()),o=e.getWeekArray(t);r.push(o);for(var i=0;i<5;i+=1){var a=t.getDate()-t.getDay()-1-7*i;if(a>0){var u=new Date(t.getFullYear(),t.getMonth(),a),s=e.getWeekArray(u);r.unshift(s)}var l=t.getDate()-t.getDay()+7+7*i;if(l<=n){var f=new Date(t.getFullYear(),t.getMonth(),l),c=e.getWeekArray(f);r.push(c)}}return r}}]),e}();r.default=a},{}],"9ksW":[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=a(e("./dom")),i=a(e("./customDate"));function a(e){return e&&e.__esModule?e:{default:e}}var u=0,s=0,l={x:0,y:0},f=function(){for(var e=o.default.of("<tr>").addClass("week"),t=0;t<7;t+=1){var r=o.default.of("<td>");e.append(r)}return e},c=function(){for(var e=o.default.of("<div>").addClass("datepicker hide"),t=o.default.of("<table>").attr("border",1).attr("cellspacing",2),r=function(){var e=o.default.of("<tr>"),t=o.default.of("<th>").addClass("prev-month").text("◂"),r=o.default.of("<th>"),n=o.default.of("<th>").addClass("next-month").text("▸"),i=o.default.of("<th>").addClass("month").attr("colspan",2),a=o.default.of("<input>").addClass("year").attr("type","number");return[t,r,o.default.of("<th>").append(a).attr("colspan",2),i,n].forEach(function(t){e.append(t)}),e}(),n=function(){var e=o.default.of("<tr>").addClass("week-sign");return[o.default.of("<th>").text("日").addClass("text-red"),o.default.of("<th>").text("一"),o.default.of("<th>").text("二"),o.default.of("<th>").text("三"),o.default.of("<th>").text("四"),o.default.of("<th>").text("五"),o.default.of("<th>").text("六").addClass("text-red")].forEach(function(t){e.append(t)}),e}(),i=o.default.of("<thead>").append(r).append(n),a=o.default.of("<tbody>"),u=0;u<6;u+=1){var s=f();a.append(s)}return t.append(i).append(a),e.append(t),e.dom},d=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t||1!==t.nodeType||"text"!==t.getAttribute("type"))throw new TypeError("参数应是一个input[type=text]");var r=new Date;return this.input=t,this.body=c(),this.current=i.default.of(r),document.body.appendChild(this.body),this.fillDayPickerByDate(this.current.toDate()),this.bindEvent(),this}return n(e,[{key:"fillDayPickerByDate",value:function(e){var t=this;if(!(e&&e instanceof Date))throw new TypeError("参数应该是一个Date实例对象");this.current=i.default.of(e);var r=i.default.getMonthArray(this.current.toDate()),n=this.body.querySelector("tbody").querySelectorAll("tr");if(this.body.querySelector(".year").value=e.getFullYear(),this.body.querySelector(".month").innerText=e.getMonth()+1,5===r.length){var o=new Date(e.getFullYear(),e.getMonth()+1,6),a=i.default.getWeekArray(o);r.push(a)}return r.forEach(function(e,o){var i=n[o].querySelectorAll("td");e.forEach(function(e,n){var a=i[n];if(a.innerText=e,0===o?Number(e)>7?a.classList.add("prev-month"):a.classList.remove("prev-month"):o>=r.length-2&&(Number(e)<15?a.classList.add("next-month"):a.classList.remove("next-month")),t.current.day===e&&!a.classList.contains("prev-month")&&!a.classList.contains("next-month")){var u=t.body.querySelector(".current-picker");u&&u.classList.remove(".current-picker"),a.classList.add(".current-picker")}})}),this}},{key:"fillDayPickerByCurrent",value:function(){var e=this.current.toDate();return this.fillDayPickerByDate(e),this}},{key:"clearPicked",value:function(){return this.body.querySelectorAll(".current-picker").forEach(function(e){e.classList.remove(".current-picker")}),this}},{key:"bindMonthArrow",value:function(){var e=this,t=this.body.querySelector(".prev-month"),r=this.body.querySelector(".next-month");return t.addEventListener("click",function(){e.current.backOneMonth(),e.fillDayPickerByCurrent()}),r.addEventListener("click",function(){e.current.aheadOneMonth(),e.fillDayPickerByCurrent()}),this}},{key:"bindPickAction",value:function(){var e=this,t=this.body.querySelector("thead"),r=this.body.querySelector("tbody").querySelectorAll("td"),n=t.querySelector(".year"),o=t.querySelector(".month"),i=this.input;return r.forEach(function(t){t.addEventListener("click",function(){var r={year:Number(n.value),month:Number(o.innerText)-1,day:Number(t.innerText)};t.classList.contains("prev-month")?(r.month-=1,r.month<0&&(r.year-=1,r.month=11)):t.classList.contains("next-month")&&(r.month+=1,r.month>11&&(r.year+=1,r.month=0));var a=new Date(r.year,r.month,r.day);e.current.reset(a),e.clearPicked(),i.value=e.current.year+"-"+(e.current.month+1)+"-"+e.current.day,t.classList.add("current-picker"),e.body.classList.add("hide")})}),this}},{key:"bindTurnOn",value:function(){var e=this;return this.input.addEventListener("mousedown",function(t){l.x=function(e){if(!o.default.isElement(e))throw new TypeError("参数应是HTML Element");for(var t=!1,r=0,n=o.default.of(e).parents(),i=[],a=n.length-1;a>-1;a-=1){var u=n[a];if("fixed"===o.default.of(u).css("position")){t=!0,i=n.slice(0,a);break}}t&&i.forEach(function(e){r+=e.scrollLeft});for(var s=e,l=0;o.default.isElement(s)&&"body"!==s.tagName&&"html"!==s.tagName;)l+=s.offsetLeft,s=s.offsetParent;return l-r}(e.input),l.y=function(e){if(!o.default.isElement(e))throw new TypeError("参数应是HTML Element");for(var t=!1,r=0,n=o.default.of(e).parents(),i=[],a=n.length-1;a>-1;a-=1){var u=n[a];if("fixed"===o.default.of(u).css("position")){t=!0,i=n.slice(0,a);break}}t&&i.forEach(function(e){r+=e.scrollTop});for(var s=e,l=0;o.default.isElement(s)&&"body"!==s.tagName&&"html"!==s.tagName;)l+=s.offsetTop,s=s.offsetParent;return l-r}(e.input),t.stopPropagation(),o.default.of(e.body).removeClass("arrow-top arrow-bottom reel hide");var r=document.querySelectorAll(".datepicker"),n=l.y,i=l.x,a=function(e,t){if(!o.default.isElement(e)||!o.default.isElement(t))throw new TypeError("参数应是HTML Element");var r=l.y,n=r-window.scrollY,i=window.scrollY+window.innerHeight-(r+t.offsetHeight)>e.offsetHeight,a=n>e.offsetHeight;return!i&&a?r-e.offsetHeight:r+t.offsetHeight}(e.body,e.input),u=function(e,t){if(!o.default.isElement(e)||!o.default.isElement(t))throw new TypeError("参数应是HTML Element");var r=l.x;return document.body.offsetWidth-t.offsetWidth-r+t.offsetWidth>e.offsetWidth+20?r:r-e.offsetWidth}(e.body,e.input),s=a<n?"arrow-bottom":"arrow-top",f=u<i?"pseudo-right":"";r.forEach(function(t){e.body.isSameNode(t)||t.classList.add("hide")}),e.fillDayPickerByCurrent(),o.default.of(e.body).addClass("reel "+s+" "+f),e.body.style.top=a+"px",e.body.style.left=u+"px"}),this}},{key:"bindTurnOff",value:function(){return!u&&(u+=1,document.body.addEventListener("mousedown",function(e){var t=e.target;document.querySelectorAll(".datepicker").forEach(function(e){o.default.of(t).hasParent(e)||e.classList.add("hide")})}),this)}},{key:"bindYearInput",value:function(){var e=this,t=this.body.querySelector(".year"),r=this.body.querySelector(".month");t.addEventListener("input",function(){var n=Number(t.value);if(!Number.isSafeInteger(n)||n<1900||n>5e3)return!1;var o={year:n,month:Number(r.innerText)-1,day:1},i=new Date(o.year,o.month,o.day);return e.fillDayPickerByDate(i),e})}},{key:"bindEvent",value:function(){(function(){if(s)return!1;s+=1;var e=function(){var e=window.innerHeight;document.body.style.minHeight=e+"px"};window.addEventListener("resize",function(){e()}),e()})(),this.bindMonthArrow(),this.bindPickAction(),this.bindTurnOn(),this.bindTurnOff(),this.bindYearInput()}}]),e}(),h=function(e){return new d(e)};window.datepicker=h,r.default=h},{"./dom":"fRxd","./customDate":"UXHO"}]},{},["9ksW"]);
},{}],"7l9t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../dom"),e=o(t),i=require("../lib/datepicker"),a=o(i),n=require("./component"),s=o(n),r=require("../utils"),d=o(r);function o(t){return t&&t.__esModule?t:{default:t}}var h={query:"mission-form",url:"./assets/templates/missionForm.html",name:"missionForm",data:function(){return{inited:0}},selectors:{contentInput:"input[name=content]",dateInput:"input[name=date]",cancelForm:".cancel-form",submit:".submit"},methods:{formSubmit:function(){var t=e.default.of(this.elements.contentInput).attr("value");t||window.alert("请输入任务内容");var i=e.default.of(this.elements.dateInput).attr("value")||"",a=Number(e.default.of(this.template).attr("data-primaryKey")),n=e.default.of(this.template).attr("data-cid"),s=Object.assign({},this.data);return s.content=t,s.date=i,a?(s.id=a,s.cid=n,this.dispatchEvent("update",s)):this.dispatchEvent("create",s),s},fill:function(){this.present=this.present||{},this.data.content=this.present.content||"",this.data.date=this.present.date||"",this.data.primaryKey=Number(this.present.primaryKey)||"",this.data.cid=this.present.cid||"",this.data.submitText=this.data.cid?"更新任务":"新建任务",e.default.of(this.elements.contentInput).attr("value",this.data.content),e.default.of(this.elements.dateInput).attr("value",this.methods.formatDate(this.data.date)),e.default.of(this.template).attr("data-primaryKey",this.data.primaryKey),e.default.of(this.template).attr("data-cid",this.data.cid),e.default.of(this.elements.submit).attr("text",this.data.submitText)},formatDate:function(t){var e=t&&t instanceof Date?t:new Date(String(t));return e.getTime()?e.toLocaleDateString().replace(/\//g,"-"):""},clear:function(){this.present={},this.methods.fill()},hide:function(){return this.methods.clear(),e.default.of(this.template).addClass("hide"),this.dispatchEvent("hide"),this},show:function(){return this.methods.fill(),e.default.of(this.template).removeClass("hide"),this.dispatchEvent("show"),this},isSeen:function(){return!e.default.of(this.template).hasClass("hide")},init:function(){return!this.data.inited&&(this.data.picker=(0,a.default)(this.elements.dateInput),e.default.of(this.data.picker.body).attr("data-c-id","c"+this.componentId),this.methods.bindEvents(),this.data.inited=1,this)},reduce:function(){var t=this;if(!this.data.cid)return d.default.newPromise();var e=s.default.findBy({componentId:Number(this.data.cid)});if(!e)throw new ReferenceError("componentId:"+this.data.cid+"的Item未找到");return this.replace(e).then(function(){return t.present={},t.methods.hide(),t})},bindEvents:function(){var t=this;return!this.data.inited&&(e.default.of(this.elements.submit).on("click",function(e){e.stopPropagation(),t.methods.formSubmit()}),e.default.of(this.elements.cancelForm).on("click",function(e){return e.stopPropagation(),t.methods.reduce().then(function(){return t.methods.hide()})}),this)}},created:function(){this.methods.init(),this.methods.show()}};exports.default=h;
},{"../dom":"fRxd","../lib/datepicker":"On9m","./component":"dB3M","../utils":"FO+Z"}],"ceID":[function(require,module,exports) {
var define;
var e;parcelRequire=function(r,t,n,o){var a="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(e,n){if(!t[e]){if(!r[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!n&&o)return o(e,!0);if(a)return a(e,!0);if(i&&"string"==typeof e)return i(e);var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}f.resolve=function(t){return r[e][1][t]||t};var c=t[e]=new u.Module(e);r[e][0].call(c.exports,f,c,c.exports,this)}return t[e].exports;function f(e){return u(f.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=r,u.cache=t,u.parent=a,u.register=function(e,t){r[e]=[function(e,r){r.exports=t},{}]};for(var s=0;s<n.length;s++)u(n[s]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof e&&e.amd&&e(function(){return c})}return u}({cdEW:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var a=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(!a)throw new ReferenceError("您的浏览器不支持indexeddb");var i=0,u=function(){return i+=1},s={databaseName:window.location.hostname,objectStoreName:"store"},c=function(e){if(!(e instanceof IDBRequest))throw new TypeError(e+"不是有效的IDBRequest");return new Promise(function(r,t){e.onsuccess=function(e){r(e.target.result)},e.onerror=function(e){t(e.target.error)}})},f=function(e,r){var t=void 0;if(e&&e instanceof Function||(t=r+" 参数callback不能是"+(void 0===e?"undefined":o(e))+"的"+e+",只接受Function类型callback"),t)throw new Error(t);return!0},h=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),new.target!==e)throw new Error("必须使用 new 命令生成实例");var t={};return t.id=u(),t.databaseName=r.databaseName||s.databaseName,t.objectStoreName=r.objectStoreName||s.objectStoreName,t.id>1&&(t.databaseName=""+t.databaseName+t.id),this.databaseName=t.databaseName,this.objectStoreName=t.objectStoreName,this}return n(e,[{key:"pushPromise",value:function(e,r){var t=this;if(!(e instanceof Promise))throw new TypeError(e+"不是Promise实例对象");if(r&&"string"!=typeof r)throw new TypeError("Error message: "+r+" 不是字符串");return this.currentPromise=this.getCurrentPromise().then(function(){return e}).catch(function(e){throw console.error(r,e,t),e}),this.currentPromise}},{key:"openDB",value:function(){var e=this,r=new Promise(function(r,t){var n=a.open(e.databaseName,e.version);n.onupgradeneeded=function(r){var t=r.target.result,n=e.objectStoreName;t.objectStoreNames.contains(n)||t.createObjectStore(n,{keyPath:"primaryKey",autoIncrement:!0})},n.onsuccess=function(t){var n=t.target.result;n.onclose=function(){n.state="closed"},n.onabort=function(){n.close()},n.onversionchange=function(){e.database=n,e.version=n.version},n.state="open",e.database=n,r(e.database)},n.onerror=function(e){t(e.target.error)}});return r.catch(function(t){return console.error("Store.openDB "+t),e.version=e.database.version,e.database.objectStoreNames.contains(e.objectStoreName)||(e.version+=1),r})}},{key:"ready",value:function(){return(this.isPrepared()?Promise.resolve(this.database):this.openDB()).catch(function(e){throw console.error("Store.ready "+e),e})}},{key:"isPrepared",value:function(){return this.database instanceof IDBDatabase&&"open"===this.database.state&&this.database.objectStoreNames.contains(this.objectStoreName)}},{key:"getStore",value:function(){if(!this.isPrepared())throw new ReferenceError("Store.getStore 数据库未准备好");return this.database.transaction(["store"],"readwrite").objectStore("store")}},{key:"getCurrentPromise",value:function(){return this.currentPromise&&this.isPrepared()||(this.currentPromise=this.ready()),this.currentPromise}},{key:"clear",value:function(){var e=this,r=this.ready().then(function(){var r=e.getStore().clear();return c(r)});return this.pushPromise(r,"Store.clear")}},{key:"getAll",value:function(){var e=this,r=this.ready().then(function(){var r=e.getStore().getAll();return c(r)});return this.pushPromise(r,"Store.getAll")}},{key:"remove",value:function(e){var r=this,t=e instanceof Array?e:[e];t.forEach(function(e){if(!Number.isSafeInteger(e))throw new TypeError("Store.remove primaryKey只接受Integer，不能是"+e)});var n=this.ready();return t.forEach(function(e){n=n.then(function(){var t=r.getStore().delete(e);return c(t)})}),n=n.then(function(){return t}),this.pushPromise(n,"Store.remove")}},{key:"get",value:function(e){var r=this,t=e instanceof Array?e:[e],n=[];t.forEach(function(e){if(!Number.isSafeInteger(e))throw new TypeError("Store.get primaryKey只接受Integer，不能是"+e)});var o=this.ready();return t.forEach(function(e){o=o.then(function(){var t=r.getStore().get(e);return c(t)}).then(function(e){n.push(e)})}),o=o.then(function(){return n}),this.pushPromise(o,"Store.get")}},{key:"push",value:function(e){var r=this,t=e instanceof Array?e:[e],n=[];t.forEach(function(e){if(!(e instanceof Object))throw new TypeError("Store.push item只接受对象，不能是"+e);if(e.primaryKey)throw new TypeError("Store.push data.primaryKey只接受null或undefiend，不能是"+e.primaryKey)});var o=this.ready();return t.forEach(function(e){o=o.then(function(){var t=r.getStore().add(e);return c(t)}).then(function(e){n.push(e)})}),o=o.then(function(){return n}),this.pushPromise(o,"Store.push")}},{key:"update",value:function(e){var r=this,t=e instanceof Array?e:[e],n=[];t.forEach(function(e){if(!(e instanceof Object))throw new TypeError("Store.update data只接受对象，不能是"+e);if(!e.primaryKey||!Number.isSafeInteger(e.primaryKey))throw new TypeError("Store.update data.primaryKey只接受Integer，不能是"+e.primaryKey)});var o=this.ready();return t.forEach(function(e){o=o.then(function(){var t=r.getStore().put(e);return c(t)}).then(function(e){n.push(e)})}),o=o.then(function(){return n}),this.pushPromise(o,"Store.update")}},{key:"formatOpenCursorWithSuccessCallback",value:function(e){var r=this,t="Store.formatOpenCursorWithSuccessCallback";f(e,t);var n=this.ready().then(function(){var t=r.getStore().openCursor();return new Promise(function(r,n){t.onsuccess=function(t){var n=t.target.result,o=e(n);!o&&n||r(o)},t.onerror=function(e){n(e.target.error)}})});return this.pushPromise(n,t)}},{key:"find",value:function(e){f(e,"Store.find");var r=void 0,t=this.formatOpenCursorWithSuccessCallback(function(t){return t&&(e(t.value,t.primaryKey)?r=t.value:t.continue()),r});return this.pushPromise(t,"Store.find")}},{key:"filter",value:function(e){f(e,"Store.filter");var r=[],t=this.formatOpenCursorWithSuccessCallback(function(t){t&&(!!e(t.value,t.primaryKey)&&r.push(t.value),t.continue())}).then(function(){return r});return this.pushPromise(t,"Store.filter")}},{key:"map",value:function(e){f(e,"Store.map");var r=[],t=this.formatOpenCursorWithSuccessCallback(function(t){if(t){var n=e(t.value,t.primaryKey);r.push(n),t.continue()}}).then(function(){return r});return this.pushPromise(t,"Store.map")}}]),e}();window.ArrayStorage=h,t.default=h},{}]},{},["cdEW"]);
},{}],"JDu1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("arraystorage"),t=u(e),n=require("./utils"),r=u(n);function u(e){return e&&e.__esModule?e:{default:e}}var i=new t.default,o=function(){return i.getAll()},f=function(){return i.filter(function(e){return e.date instanceof Date&&r.default.differDay(e.date,r.default.now)>0})},a=function(){return i.filter(function(e){return"done"===e.state})},d=function(){return i.filter(function(e){return"done"!==e.state})},l={all:o,expired:f,done:a,undone:d},s=function(){return i.filter(function(e){return e.date instanceof Date&&r.default.differDay(e.date,r.default.now)>0})},c=function(e){return i.filter(function(t){return"string"==typeof t.mark&&t.mark===String(e)})},g=function(e){var t=void 0;return"string"==typeof e?t=l[e]?l[e]():c(e):e instanceof Date?t=s(e):console.warn("mission.methods.GetQuery 尚不支持查询"+e),t};i.methods={getAll:o,getExpired:f,getDate:s,getMark:c,getQuery:g},exports.default=i;
},{"arraystorage":"ceID","./utils":"FO+Z"}],"XGW9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../dom"),e=d(t),n=require("../model"),a=d(n),i=require("./component"),r=d(i),s=require("../utils"),o=d(s);function d(t){return t&&t.__esModule?t:{default:t}}var m={query:"mission-list-item",url:"./assets/templates/missionListItem.html",name:"missionListItem",selectors:{template:".template",content:".item-content",date:".item-date",finish:".finish",itemMain:".item-main",counter:"#counter",remove:"a[name=remove]"},data:function(){return{counter:1,inited:0}},methods:{init:function(){return!this.data.inited&&(this.data.inited=1,this.methods.bindEvents(),this)},bindEvents:function(){var t=this;e.default.of(this.elements.finish).on("click",function(){var n="done"===t.present.state?"undone":"done",i={content:t.present.content,date:o.default.isValidDate(t.present.date)?t.present.date:"",primaryKey:Number(t.present.primaryKey),state:n};a.default.update(i).then(function(){e.default.of(t.template).toggleClass("done")})}),e.default.of(this.elements.content).on("click",function(){if(!t.data.formId)throw new Error("Item.data.formId不能为"+t.data.formId);var n=o.default.newPromise(),a=r.default.findBy({componentId:Number(t.data.formId)}),i={cid:t.componentId,content:t.data.content,date:t.data.date,primaryKey:t.present.primaryKey,formId:t.data.formId};return a.present=i,n=n.then(function(){e.default.of(t.template).parents().forEach(function(t){t.scrollTop>0&&a.methods.isSeen()&&!a.data.primaryKey&&t.scrollBy(0,0)})}).then(function(){return a.methods.reduce()}).then(function(){return t.replace(a)}).then(function(){a.present=i,a.methods.show()})}),e.default.of(this.elements.remove).on("click",function(){return a.default.remove(t.present.primaryKey).then(function(){return t.template.style.height="0px",t.template.style.paddingTop="0px",t.template.style.paddingBottom="0px",setTimeout(function(){return t.parent.removeChild(t)},1e3)})})},fill:function(){this.present=this.present||{},this.data.content=this.present.content,this.data.date=this.present.date,this.data.id=this.present.id,this.data.formId=this.present.formId;var t=o.default.formatDate(this.present.date);e.default.of(this.elements.content).attr("text",this.present.content),e.default.of(this.elements.date).attr("text",t),this.present.date instanceof Date&&o.default.differDay(this.present.date,o.default.now)>0&&e.default.of(this.elements.date).addClass("expired"),e.default.of(this.template).attr("data-primaryKey",this.present.primaryKey),"done"===this.present.state&&e.default.of(this.template).addClass("done")}},created:function(){this.methods.init(),this.methods.fill()}};exports.default=m;
},{"../dom":"fRxd","../model":"JDu1","./component":"dB3M","../utils":"FO+Z"}],"5qA9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./missionForm"),t=c(e),n=require("./component"),r=c(n),i=require("../dom"),a=c(i),d=require("../model"),o=c(d),s=require("./missionListItem"),u=c(s),m=require("../utils"),f=c(m);function c(e){return e&&e.__esModule?e:{default:e}}var h=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],l={query:"mission-card",url:"./assets/templates/missionCard.html",name:"missionCard",data:function(){return{items:[],dayMark:"",dateMark:""}},passon:[],selectors:{form:"mission-form",cardHeader:".card-header",showForm:".show-form",createMission:".create-mission",cardBody:".card-body"},components:[t.default],methods:{init:function(){var e=this;if(this.data.inited)return!1;this.data.date=this.present.date,this.data.days=this.present.days;var t=f.default.newPromise().then(function(){return e.methods.initForm()}).then(function(){return e.methods.loadDB()}).then(function(){return e.methods.initItems()});return this.data.inited=1,t},initItems:function(){var e=this,t=f.default.newPromise();return this.data.items.forEach(function(n){t=t.then(function(){return e.methods.appendItem(n)})}),t},loadDB:function(){var e=this;return o.default.methods.getQuery(this.present.query).then(function(t){var n=f.default.divisio(t,function(e){return"done"!==e.state}).map(function(e){return f.default.divisio(e,function(e){return f.default.isValidDate(e.date)})}).map(function(e){return[e[0].sort(function(e,t){return e.date>=t.date}),e[1]]}),r=f.default.flat(n,2);return e.data.items=r,e.data.items})},appendItem:function(e){var t=Object.assign(e);t.formId=this.data.formId;var n=Object.assign({present:t},u.default),r=a.default.of(this.elements.form).getIndex();return this.appendChild(n,this.elements.cardBody,r)},initForm:function(){var e=this,n=this.findBy({name:t.default.name});return!!n&&(this.data.form=n,this.data.formId=n.componentId,n.addEventListener("hide",function(){a.default.of(e.elements.createMission).removeClass("hide")}),n.addEventListener("show",function(){}),n.methods.hide(),a.default.of(this.elements.showForm).on("click",function(){return n.methods.reduce().then(function(){var t=a.default.of(e.elements.createMission).getIndex();return e.appendChild(n,e.elements.cardBody,t)}).then(function(){n.present={date:e.data.date},n.methods.show()})}),n.addEventListener("create",function(t){if(!t.detail.content)return!1;var r={content:t.detail.content,date:new Date(t.detail.date)};return o.default.push(r).then(function(t){return r.primaryKey=t,e.methods.appendItem(r)}).then(function(){return n.methods.hide()})}),n.addEventListener("update",function(t){if(!t.detail.content)return!1;var i={content:t.detail.content,date:t.detail.date,primaryKey:t.detail.primaryKey},a=Object.assign({cid:e.componentId,formId:e.data.formId},i);return o.default.update(i).then(function(n){var i=r.default.findBy({componentId:Number(t.detail.cid)});a.primaryKey=n,i.present=a,i.methods.fill(),e.replaceChild(i,e.data.form)}).then(function(){return n.methods.hide()}),a}),n)}},created:function(){this.methods.init()}};exports.default=l;
},{"./missionForm":"7l9t","./component":"dB3M","../dom":"fRxd","../model":"JDu1","./missionListItem":"XGW9","../utils":"FO+Z"}],"4my8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./leftMenu"),t=u(e),i=require("./missionCard"),r=u(i),n=require("../dom"),s=u(n);function u(e){return e&&e.__esModule?e:{default:e}}var l={all:"所有任务",expired:"已过期",done:"已完成",undone:"未完成"},o={query:"mission-content",url:"./assets/templates/welcome.html",name:"welcome",present:{text:l},selectors:{title:".title",left:".left"},data:function(){return{}},methods:{init:function(){return!this.data.inited&&(this.data.inited=1,this)}},created:function(){var e=l[this.present.query]||String(this.present.query);s.default.of(this.elements.title).attr("text",e),this.methods.init()},components:[t.default,r.default]};exports.default=o;
},{"./leftMenu":"OU4j","./missionCard":"5qA9","../dom":"fRxd"}],"HYhh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./welcome"),e=n(t),r=require("./component"),a=n(r);function n(t){return t&&t.__esModule?t:{default:t}}var i={query:"router",url:"./assets/templates/router.html",name:"router",data:function(){return{counter:1,current:this,inited:0,path:"",state:{},origin:window.location.href.match(/^[^#]+/)[0],href:window.location.href}},route:{welcome:e.default},methods:{init:function(){return!this.data.inited&&(this.data.inited=1,this)},render:function(t,e){var r=this,n=this.route[String(t)];if(!n)throw new Error("路径"+t+"对应Component不存在");this.data.path=t,this.data.state=Object.assign({},e);var i=Object.assign({},n),o=Object.assign({},i.present,this.data.state);i.present=o;var s=this.data.current;return s.replace(i).then(function(e){s!==r&&a.default.removeComponent(s),r.data.current=e;var n=r.data.origin.replace(/\u002f$/,"")+"/#/"+t+"/";return window.history.pushState(r.data.state,0,n),r.data.href=window.location.href,e})},restore:function(){return!!this.data.path&&this.methods.render(this.data.path,this.data.state)}},created:function(){this.methods.init(),window.router=this,this.methods.render("welcome",{query:"all"})}};exports.default=i;
},{"./welcome":"4my8","./component":"dB3M"}],"aDHB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./component"),t=r(e),n=require("./router"),o=r(n),i=require("../dom"),d=r(i);function r(e){return e&&e.__esModule?e:{default:e}}window.Dom=d.default;var u=function(){document.addEventListener("DOMContentLoaded",function(){window.addEventListener("resize",function(){document.body.style.offsetHeight=window.innerHeight+"px"}),window.resizeTo(window.innerWidth,window.innerHeight),t.default.pjaxCreate(o.default)})};exports.default=u;
},{"./component":"dB3M","./router":"HYhh","../dom":"fRxd"}],"Focm":[function(require,module,exports) {
"use strict";var e=require("./components/main"),n=t(e);function t(e){return e&&e.__esModule?e:{default:e}}window.now=new Date,(0,n.default)();
},{"./components/main":"aDHB"}]},{},["Focm"], null)
//# sourceMappingURL=/index.map